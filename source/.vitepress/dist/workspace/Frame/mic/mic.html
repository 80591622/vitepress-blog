<!DOCTYPE html>
<html lang="zh" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>微前端 | Oasis Blog</title>
    <meta name="description" content="软件开发计：开发文档和开发计划，完成功能工具，和待开发的功能和工具">
    <meta name="generator" content="VitePress v1.1.3">
    <link rel="preload stylesheet" href="/assets/style.grOXRGuY.css" as="style">
    
    <script type="module" src="/assets/app.FK1aG7ez.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.BQQWXjGs.js">
    <link rel="modulepreload" href="/assets/chunks/theme.Df-VPS2d.js">
    <link rel="modulepreload" href="/assets/workspace_Frame_mic_mic.md.BZNBSOf3.lean.js">
    <link rel="icon" type="image/x-icon" href="	https://vitepress.dev/vitepress-logo-mini.svg">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5d98c3a5><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0f60ec36></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0f60ec36> Skip to content </a><!--]--><!----><header class="VPNav" data-v-5d98c3a5 data-v-ae24b3ad><div class="VPNavBar has-sidebar top" data-v-ae24b3ad data-v-ccf7ddec><div class="wrapper" data-v-ccf7ddec><div class="container" data-v-ccf7ddec><div class="title" data-v-ccf7ddec><div class="VPNavBarTitle has-sidebar" data-v-ccf7ddec data-v-ab179fa1><a class="title" href="/" data-v-ab179fa1><!--[--><!--]--><!----><span data-v-ab179fa1>Oasis Blog</span><!--[--><!--]--></a></div></div><div class="content" data-v-ccf7ddec><div class="content-body" data-v-ccf7ddec><!--[--><!--]--><div class="VPNavBarSearch search" data-v-ccf7ddec><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索文档"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">搜索文档</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-ccf7ddec data-v-7f418b0f><span id="main-nav-aria-label" class="visually-hidden" data-v-7f418b0f>Main Navigation</span><!--[--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-7f418b0f data-v-b6c34ac9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-b6c34ac9><span class="text" data-v-b6c34ac9><!----><span data-v-b6c34ac9>Useful</span><span class="vpi-chevron-down text-icon" data-v-b6c34ac9></span></span></button><div class="menu" data-v-b6c34ac9><div class="VPMenu" data-v-b6c34ac9 data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/workspace/Frame/vue/vue.html" data-v-43f1e123><!--[-->Vue<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/workspace/Frame/react/react.html" data-v-43f1e123><!--[-->React<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/workspace/Frame/taro/taroBase.html" data-v-43f1e123><!--[-->Taro<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-ccf7ddec data-v-e6aabb21><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-e6aabb21 data-v-d1f28634 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-d1f28634></span><span class="vpi-moon moon" data-v-d1f28634></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-ccf7ddec data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://gitee.com/muyaCode/program-learn-notes" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-eee4e7cb><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-ccf7ddec data-v-d0bd9dde data-v-b6c34ac9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-b6c34ac9><span class="vpi-more-horizontal icon" data-v-b6c34ac9></span></button><div class="menu" data-v-b6c34ac9><div class="VPMenu" data-v-b6c34ac9 data-v-e7ea1737><!----><!--[--><!--[--><!----><div class="group" data-v-d0bd9dde><div class="item appearance" data-v-d0bd9dde><p class="label" data-v-d0bd9dde>Appearance</p><div class="appearance-action" data-v-d0bd9dde><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-d0bd9dde data-v-d1f28634 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-d1f28634></span><span class="vpi-moon moon" data-v-d1f28634></span><!--]--></span></span></button></div></div></div><div class="group" data-v-d0bd9dde><div class="item social-links" data-v-d0bd9dde><div class="VPSocialLinks social-links-list" data-v-d0bd9dde data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://gitee.com/muyaCode/program-learn-notes" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-eee4e7cb><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-ccf7ddec data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-ccf7ddec><div class="divider-line" data-v-ccf7ddec></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-5d98c3a5 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a6f0e41e><span class="vpi-align-left menu-icon" data-v-a6f0e41e></span><span class="menu-text" data-v-a6f0e41e>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-267dd0ed><button data-v-267dd0ed>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-5d98c3a5 data-v-575e6a36><div class="curtain" data-v-575e6a36></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-575e6a36><span class="visually-hidden" id="sidebar-aria-label" data-v-575e6a36> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-575e6a36><section class="VPSidebarItem level-0 collapsible" data-v-575e6a36 data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h2 class="text" data-v-b8d55f3b>Base</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Js/home.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>技术清单</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Js/array.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Array的方法简单整理</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Js/object.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Object的方法简单整理</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Js/string.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>String的方法简单整理</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Js/date.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Date时间</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Js/reg.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>RegExp正则</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Css/css.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>CSS使用锦囊</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Js/dispatchEvent.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>自定义事件</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Js/for-in-for-of.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>for in和for of区别</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Js/es6.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>ES6-新增特性一览</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Js/eventloop.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Event-Loop</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Js/promise.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Promise & async</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Js/webWorker.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Web Worker</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Js/socket.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>WebSocket & socket.io</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Project/linux.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>shell & ssh</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Project/yarn.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>yarn & npm</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Js/heap_stack.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>堆内存 & 栈内存</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Js/xhr.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Fetch和Axios的区别</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Js/design-pattern.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>JS设计模式探索</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Js/http-base.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>输入URL背后的技术步骤</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Js/extends.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>原型与原型链</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Project/leetcode.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>leetCode</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-575e6a36><section class="VPSidebarItem level-0 collapsible collapsed" data-v-575e6a36 data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h2 class="text" data-v-b8d55f3b>Project</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Project/method.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>用到的方法</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Project/cookie.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>简易封装Cookie</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Project/toFixed.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>toFixed方法的bug</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Project/copy.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>实现JS复制内容到剪贴板</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Project/screenfull.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>全屏实现方案</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Project/qiyunniu.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>base64上传七云获取key</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Js/theme.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>聊一聊前端换肤</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Js/water-mask.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>JS添加水印功能</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Js/export.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Axios 获取文件流导出 excel 表格</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Project/more.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>会用到的插件</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-575e6a36><section class="VPSidebarItem level-0 collapsible collapsed" data-v-575e6a36 data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h2 class="text" data-v-b8d55f3b>FE框架</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><section class="VPSidebarItem level-1 collapsible collapsed" data-v-b8d55f3b data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h3 class="text" data-v-b8d55f3b>☞ vue</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/vue/vue.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>vue基本用法</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/vue/jsx.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>vue中使用JSX</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/vue/vue-cli.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>脚手架vue-cli</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/vue/problem.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>问题验证解析</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/vue/prerender.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Vue预渲染</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-2 collapsible collapsed" data-v-b8d55f3b data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h4 class="text" data-v-b8d55f3b>踩坑记录</h4><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-3 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/vue/keep-alive.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>使用keepAlive遇到的坑</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-2 collapsible collapsed" data-v-b8d55f3b data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h4 class="text" data-v-b8d55f3b>使用拓展</h4><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-3 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/vue/table-jsx.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>vue之JSX封装table</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/vue/sortable.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Element-UI ，Table组件实现拖拽效果</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/vue/with-search.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Vue之JSX封装搜索头部</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/vue/tree-menu.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>封装树形菜单</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/vue/reload.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>基于Vue的组件局部刷新</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-2 collapsible collapsed" data-v-b8d55f3b data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h4 class="text" data-v-b8d55f3b>源码分析</h4><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-3 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/vue/next/reactivity.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>vue3.0源码分析-1</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/vue/vue-next.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Vue3.0源码分析-2</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/vue/error-handler.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Vue之JSX封装搜索头部</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/vue/source-code/keep-alive.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>封装树形菜单</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/vue/source-code/vue-extend.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>基于Vue的组件局部刷新</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-2 collapsible collapsed" data-v-b8d55f3b data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h4 class="text" data-v-b8d55f3b>UI组件库</h4><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-3 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/irdd/irdd.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>irdd 组件库</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-b8d55f3b data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h3 class="text" data-v-b8d55f3b>☞ react</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/react/react.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>React基本用法</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/react/react-hooks.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Hooks</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/react/immer.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Immer</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/react/react-router.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Router原理</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/react/react-redux.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Redux源码解析</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/react/dva.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Dva封装</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/react/event.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>react事件委托机制</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/react/fiber.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>React16 Fiber</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/react/dom_diff.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>VirtualDOM</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/react/ssr.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>React-SSR</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/react/problem.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>问题验证解析</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-b8d55f3b data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h3 class="text" data-v-b8d55f3b>☞ taro</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/taro/taroBase.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Taro基本用法</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/taro/taroAdvanced.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Taro一些配置</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/taro/template.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Node生成模板</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/taro/toc.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>项目目录</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-b8d55f3b data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h3 class="text" data-v-b8d55f3b>☞ react-native</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/react-native/guide.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>RN基本用法</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/react-native/base.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>RN IOS环境搭建</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/react-native/bug.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>XCODE模拟器报错修复</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-b8d55f3b data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h3 class="text" data-v-b8d55f3b>☞ 单元测试</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Frame/unit-test/jest.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>单元测试框架Jest学习总结</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="group" data-v-575e6a36><section class="VPSidebarItem level-0 collapsible collapsed" data-v-575e6a36 data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h2 class="text" data-v-b8d55f3b>Server</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><section class="VPSidebarItem level-1 collapsible collapsed" data-v-b8d55f3b data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h3 class="text" data-v-b8d55f3b>☞ NodeJS</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Server/node/base.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>NodeJs的原生方法</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Server/node/node-1.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Koa2</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Server/node/node-2.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>NodeJs 插件拓展</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Server/node/pm2.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Node启动工具</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Server/node/node-console.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>终端实现console输出不同颜色</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-b8d55f3b data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h3 class="text" data-v-b8d55f3b>☞ Mongoose</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Server/sql/mongodb.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Mongodb安装</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Server/sql/mongoose.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Mongoose使用</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-b8d55f3b data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h3 class="text" data-v-b8d55f3b>☞ Nginx</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Server/nginx/nginx_base.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Nginx的使用指南</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Server/nginx/nginx_local.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>安装Nginx踩到的坑</p><!--]--></a><!----></div><!----></div><!--]--></div></section><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Server/lnmp.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>云服务器配置</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Server/token.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>什么是cookie,token和session?它们之间有什么关系？</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-575e6a36><section class="VPSidebarItem level-0 collapsible collapsed" data-v-575e6a36 data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h2 class="text" data-v-b8d55f3b>TypeScript</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Typescript/ts.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>TypeScript</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Typescript/ts-object-type-interface.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>TypeScr 误区</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Typescript/tsConfig.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>tsconfig了解一下</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-575e6a36><section class="VPSidebarItem level-0 collapsible collapsed" data-v-575e6a36 data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h2 class="text" data-v-b8d55f3b>构建工具 </h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><section class="VPSidebarItem level-1 collapsible collapsed" data-v-b8d55f3b data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h3 class="text" data-v-b8d55f3b>☞ webpack</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Webpack/webpack.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Webpack4 配置详解</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Webpack/use.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Webpack的使用</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Webpack/babel_polyfill.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>babel_polyfill</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-b8d55f3b data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h3 class="text" data-v-b8d55f3b>☞ gulp</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Gulp/base.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>gulp</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-b8d55f3b data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h3 class="text" data-v-b8d55f3b>☞ rollup</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Rollup/base.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>rollup</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-b8d55f3b data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h3 class="text" data-v-b8d55f3b>☞ snowpack</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Snowpack/base.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>snowpack</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-b8d55f3b data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h3 class="text" data-v-b8d55f3b>☞ vite</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Vite/base.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>vite</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="group" data-v-575e6a36><section class="VPSidebarItem level-0 collapsible collapsed" data-v-575e6a36 data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h2 class="text" data-v-b8d55f3b>Git教程</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Git/git.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>git基础</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Git/git-cherry.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>git恢复上一次的修改</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Git/git-hooks.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>git hooks</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Git/github.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>github API 调用</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-575e6a36><section class="VPSidebarItem level-0 collapsible collapsed" data-v-575e6a36 data-v-b8d55f3b><div class="item" role="button" tabindex="0" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><h2 class="text" data-v-b8d55f3b>Other</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b8d55f3b><span class="vpi-chevron-right caret-icon" data-v-b8d55f3b></span></div></div><div class="items" data-v-b8d55f3b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Jenkins/base.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>Jenkins自动化部署</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/tools/mac.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>MAC整理</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/tools/store.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>开发工具</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/tools/page.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>网站大全</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/other/ws-configure.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>配置WS</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-b8d55f3b data-v-b8d55f3b><div class="item" data-v-b8d55f3b><div class="indicator" data-v-b8d55f3b></div><a class="VPLink link link" href="/workspace/Interviews/result.html" data-v-b8d55f3b><!--[--><p class="text" data-v-b8d55f3b>习题解答</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5d98c3a5 data-v-1428d186><div class="VPDoc has-sidebar has-aside" data-v-1428d186 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" role="navigation" data-v-3f215769 data-v-935f8a84><div class="content" data-v-935f8a84><div class="outline-marker" data-v-935f8a84></div><div class="outline-title" role="heading" aria-level="2" data-v-935f8a84>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-935f8a84><span class="visually-hidden" id="doc-outline-aria-label" data-v-935f8a84> Table of Contents for current page </span><ul class="VPDocOutlineItem root" data-v-935f8a84 data-v-b933a997><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _workspace_Frame_mic_mic" data-v-39a288b8><div><h1 id="微前端" tabindex="-1">微前端 <a class="header-anchor" href="#微前端" aria-label="Permalink to &quot;微前端&quot;">​</a></h1><p>代码的天敌就是代码量</p><p><img src="https://s.pc.qq.com/tousu/img/20200910/1008611_1599722415.jpg" alt=""></p><h2 id="前言" tabindex="-1">前言 <a class="header-anchor" href="#前言" aria-label="Permalink to &quot;前言&quot;">​</a></h2><p><strong>什么是微前端 ？？</strong></p><p>微前端是一种类似于微服务的架构，它将微服务的理念应用于浏览器端，即将单页面前端应用由单一的单体应用转变为把多个小型前端应用聚合起来的应用。各个前端应用可以使用不同的技术栈独立开发、独立运行、独立部署</p><p><strong>微前端架构具备以下几个<code>核心价值：</code></strong></p><ul><li><p>技术栈无关，接入友好 主框架不限制接入应用的技术栈，子应用具备完全自主权</p></li><li><p>独立开发、独立部署（业务域） 子应用仓库独立，前后端可独立开发，部署完成后主框架自动完成同步更新</p></li><li><p>增量升级</p><p>在面对各种复杂场景时，我们通常很难对一个已经存在的系统做全量的技术栈升级或重构，而微前端是一种非常好的实施渐进式重构的手段和策略</p></li><li><p>独立运行时 每个子应用之间状态隔离，运行时状态不共享</p></li></ul><p><strong>解决的问题</strong>！！</p><p>微前端架构旨在解决单体应用在一个相对长的时间跨度下，由于参与的人员、团队的增多、变迁，从一个普通应用演变成一个巨石应用后，随之而来的应用不可维护的问题，这类问题在企业级 Web 应用中尤其常见。</p><h2 id="why-not-iframe" tabindex="-1">Why Not Iframe？ <a class="header-anchor" href="#why-not-iframe" aria-label="Permalink to &quot;Why Not Iframe？&quot;">​</a></h2><p><a href="https://www.yuque.com/kuitos/gky7yw/gesexv" target="_blank" rel="noreferrer">https://www.yuque.com/kuitos/gky7yw/gesexv</a></p><p>iframe 最大的特性就是提供了浏览器原生的硬隔离方案，不论是样式隔离、js 隔离这类问题统统都能被完美解决。但他的最大问题也在于他的隔离性无法被突破，导致应用间上下文无法被共享，随之带来的开发体验、产品体验的问题。</p><ol><li>url 不同步。浏览器刷新 iframe url 状态丢失、后退前进按钮无法使用。</li><li>UI 不同步，DOM 结构不共享。想象一下屏幕右下角 1/4 的 iframe 里来一个带遮罩层的弹框，同时我们要求这个弹框要浏览器居中显示，还要浏览器 resize 时自动居中..</li><li>全局上下文完全隔离，内存变量不共享。iframe 内外系统的通信、数据同步等需求，主应用的 cookie 要透传到根域名都不同的子应用中实现免登效果。</li><li>慢。每次子应用进入都是一次浏览器上下文重建、资源重新加载的过程。</li></ol><p>其中有的问题比较好解决(问题1)，有的问题我们可以睁一只眼闭一只眼(问题4)，但有的问题我们则很难解决(问题3)甚至无法解决(问题2)，而这些无法解决的问题恰恰又会给产品带来非常严重的体验问题， 最终导致我们舍弃了 iframe 方案。</p><h2 id="跟-iframe、web-components、npm包、路由分发、插件有什么区别" tabindex="-1">跟 iFrame、Web Components、NPM包、路由分发、插件有什么区别? <a class="header-anchor" href="#跟-iframe、web-components、npm包、路由分发、插件有什么区别" aria-label="Permalink to &quot;跟 iFrame、Web Components、NPM包、路由分发、插件有什么区别?&quot;">​</a></h2><table><thead><tr><th>微前端</th><th style="text-align:left;"><a href="./[https://baike.baidu.com/item/微件/8626501.html?fromtitle=Widget&amp;fromid=127396&amp;fr=aladdin](https://baike.baidu.com/item/微件/8626501?fromtitle=Widget&amp;fromid=127396&amp;fr=aladdin)">Widget</a> / 业务组件</th></tr></thead><tbody><tr><td>架构体系。用来实现大型Web应用</td><td style="text-align:left;">以库(外联/npm)的形式实现复用</td></tr><tr><td>生产方式</td><td style="text-align:left;">生产工具</td></tr><tr><td><code>通过隔离机制实现技术栈无关</code></td><td style="text-align:left;"><code>需要人工解决依赖和冲突问题 </code></td></tr><tr><td>单独构建 \ 单独发布 \ 热升级</td><td style="text-align:left;">整体构建 \ 整体发布</td></tr><tr><td>体系化治理，可控性强</td><td style="text-align:left;">可控性差</td></tr><tr><td>主从关系(路由映射、消息机制)</td><td style="text-align:left;">相互无关</td></tr><tr><td>微应用是产品的子集(粒度大)</td><td style="text-align:left;">通用功能(粒度小)</td></tr><tr><td>变化快</td><td style="text-align:left;">变化小</td></tr><tr><td>若干微应用的组合</td><td style="text-align:left;">“外挂”</td></tr></tbody></table><h2 id="微前端架构实践中的问题" tabindex="-1">微前端架构实践中的问题 <a class="header-anchor" href="#微前端架构实践中的问题" aria-label="Permalink to &quot;微前端架构实践中的问题&quot;">​</a></h2><ul><li><p>SPA VS MPA</p><p>MPA 方案的优点在于 部署简单、各应用之间硬隔离，天生具备技术栈无关、独立开发、独立部署的特性。缺点则也很明显，应用之间<strong>切换会造成浏览器重刷</strong>，由于产品域名之间相互跳转，流程体验上会存在断点。</p><p>SPA 则天生具备体验上的优势，应用直接无刷新切换，能极大的保证多产品之间流程操作串联时的流程性。缺点则在于各应用技术栈之间是强耦合的。</p><p>那我们有没有可能将 MPA 和 SPA 两者的优势结合起来，构建出一个相对完善的微前端架构方案呢？</p></li><li><p>构建时组合 VS 运行时组合</p></li><li><p>JS Entry vs HTML Entry</p><p>优势就是html-entry 巧妙的避开了js-entry加载子应用js的hash问题</p><p>html entry 的好处是子应用依赖的资源不用过于关心</p></li><li><p>样式隔离</p><p>微前端只能做到子应用之间是不会相互干扰的，父应用一般做的很少，就只有左侧菜单个顶部导航栏，很少会有跟子应用之间有样式之间的冲突，如果有的话就把父应用的权重提高就行了。</p><ul><li><p>Shadow DOM</p><p>基于 <a href="https://www.jianshu.com/p/29ff55319003" target="_blank" rel="noreferrer">Web Components</a> 的 Shadow DOM 能力（内外完全没联系），我们可以将每个子应用包裹到一个 Shadow DOM 中，保证其运行时的样式的绝对隔离。</p><p>但 Shadow DOM 方案在工程实践中会碰到一个常见问题，比如我们这样去构建了一个在 Shadow DOM 里渲染的子应用：</p><div class="language-js line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> shadow</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">querySelector</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;#hostElement&#39;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">attachShadow</span><span style="color:#ABB2BF;">({</span><span style="color:#E06C75;">mode</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;open&#39;</span><span style="color:#ABB2BF;">});</span></span>
<span class="line"><span style="color:#E5C07B;">shadow</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">innerHTML</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> `</span></span>
<span class="line"><span style="color:#98C379;">    &lt;style&gt;</span></span>
<span class="line"><span style="color:#98C379;">    h2{</span></span>
<span class="line"><span style="color:#98C379;">    color:red</span></span>
<span class="line"><span style="color:#98C379;">    }</span></span>
<span class="line"><span style="color:#98C379;">    &lt;/style&gt;</span></span>
<span class="line"><span style="color:#98C379;">    &lt;h2&gt;Shadow&lt;/h2&gt;</span></span>
<span class="line"><span style="color:#98C379;">`</span><span style="color:#ABB2BF;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>由于子应用的样式作用域仅在 shadow 元素下，那么一旦子应用中出现运行时越界跑到外面构建 DOM 的场景，必定会导致构建出来的 DOM 无法应用子应用的样式的情况。</p><p>比如 sub-app 里调用了 antd modal 组件，由于 modal 是动态挂载到 document.body 的，而由于 Shadow DOM 的特性 antd 的样式只会在 shadow 这个作用域下生效，结果就是弹出框无法应用到 antd 的样式。解决的办法是把 antd 样式上浮一层，丢到主文档里，但这么做意味着子应用的样式直接泄露到主文档了。gg...</p></li><li><p>CSS Module? BEM?</p><p>社区通常的实践是通过约定 css 前缀的方式来避免样式冲突(人肉不推荐)，即各个子应用使用特定的前缀来命名 class，或者直接基于 css module 方案写样式。对于一个全新的项目，这样当然是可行，但是通常微前端架构更多的目标是解决<strong>存量/遗产</strong> 应用的接入问题。<strong>很显然遗产应用通常是很难有动力做大幅改造的</strong>。</p><p>最主要的是，约定的方式有一个无法解决的问题，假如子应用中使用了三方的组件库，三方库在写入了大量的<strong>全局样式</strong>的同时又不支持定制化前缀？比如 a 应用引入了 antd 2.x，而 b 应用引入了 antd 3.x，两个版本的 antd 都写入了全局的 <code>.menu class</code>，但又彼此不兼容怎么办？<a href="https://ant.design/components/config-provider-cn/" target="_blank" rel="noreferrer">antd</a></p></li><li><p>Dynamic Stylesheet</p><p><strong>动态 加载/卸载 样式表</strong></p><p>解决方案其实很简单，我们只需要在应用切出/卸载后，同时卸载掉其样式表即可，原理是浏览器会对所有的样式表的插入、移除做整个 CSSOM 的重构，从而达到 插入、卸载 样式的目的。这样即能保证，在一个时间点里，只有一个应用的样式表是生效的。</p><p>上文提到的 HTML Entry 方案则天生具备样式隔离的特性，因为应用卸载后会直接移除去 HTML 结构，从而自动移除了其样式表。</p><p>比如 HTML Entry 模式下，子应用加载完成的后的 DOM 结构可能长这样：</p><div class="language-html line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">html</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  &lt;</span><span style="color:#E06C75;">body</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">main</span><span style="color:#D19A66;"> id</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;subApp&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">      // 子应用完整的 html 结构</span></span>
<span class="line"><span style="color:#ABB2BF;">      &lt;</span><span style="color:#E06C75;">link</span><span style="color:#D19A66;"> rel</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;stylesheet&quot;</span><span style="color:#D19A66;"> href</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;//alipay.com/subapp.css&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">      &lt;</span><span style="color:#E06C75;">div</span><span style="color:#D19A66;"> id</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;root&quot;</span><span style="color:#ABB2BF;">&gt;....&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;/</span><span style="color:#E06C75;">main</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">  &lt;/</span><span style="color:#E06C75;">body</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">&lt;/</span><span style="color:#E06C75;">html</span><span style="color:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>当子应用被替换或卸载时，<code>subApp</code> 节点的 innerHTML 也会被复写，<code>//alipay.com/subapp.css</code> 也就自然被移除样式也随之卸载了。</p></li></ul></li><li><p>JS 隔离</p><p>基于proxy</p><p>解决了样式隔离的问题后，有一个更关键的问题我们还没有解决：如何确保各个子应用之间的全局变量不会互相干扰，从而保证每个子应用之间的软隔离？</p><p>这个问题比样式隔离的问题更棘手，社区的普遍玩法是给一些全局副作用加各种前缀从而避免冲突。但其实我们都明白，这种通过团队间的”口头“约定的方式往往低效且易碎，所有依赖人为约束的方案都很难避免由于人的疏忽导致的线上 bug。那么我们是否有可能打造出一个好用的且完全无约束的 JS 隔离方案呢？</p><p>针对 JS 隔离的问题，我们独创了一个运行时的 JS 沙箱。简单画了个架构图：</p><p><img src="https://s.pc.qq.com/tousu/img/20200916/1008611_1600242604.jpg" alt=""></p><p>即在应用的 bootstrap 及 mount 两个生命周期开始之前分别给全局状态打下快照，然后当应用切出/卸载时，将状态回滚至 bootstrap 开始之前的阶段，确保应用对全局状态的污染全部清零。而当应用二次进入时则再恢复至 mount 前的状态的，从而确保应用在 remount 时拥有跟第一次 mount 时一致的全局上下文。</p><p>当然沙箱里做的事情还远不止这些，其他的还包括一些对全局事件监听的劫持等，以确保应用在切出之后，对全局事件的监听能得到完整的卸载，同时也会在 remount 时重新监听这些全局事件，从而模拟出与应用独立运行时一致的沙箱环境。</p></li><li><p>资源预加载基座</p><p>在浏览器空闲时间预加载（fetch 跨域）未打开的子应用资源，加速子应用打开速度。</p></li></ul><h2 id="子应用的划分" tabindex="-1">子应用的划分 <a class="header-anchor" href="#子应用的划分" aria-label="Permalink to &quot;子应用的划分&quot;">​</a></h2><p>在微前端架构中，我们应该按业务划分出对应的子应用，而不是通过功能模块划分子应用。这么做的原因有两个：</p><ol><li>在微前端架构中，子应用并不是一个模块，而是一个独立的应用，我们将子应用按业务划分可以拥有更好的可维护性和解耦性。</li><li><code>**</code> 子应用应该具备独立运行的能力，防止应用间频繁的通信(减少耦合)</li></ol><h2 id="接入qiankun" tabindex="-1">接入qiankun <a class="header-anchor" href="#接入qiankun" aria-label="Permalink to &quot;接入qiankun&quot;">​</a></h2><h3 id="构建主应用基座" tabindex="-1">构建主应用基座 <a class="header-anchor" href="#构建主应用基座" aria-label="Permalink to &quot;构建主应用基座&quot;">​</a></h3><p>这里用vue作为主应用，接入其他的子应用</p><p>乾坤提供的<a href="https://qiankun.umijs.org/zh/api/" target="_blank" rel="noreferrer">API</a>,一共没几个，接入方式特别简单。</p><p>子应用注册信息</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// mic/micro-app-vue-main/src/micro/app.js</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// https://github.com/wkvictory/mic/blob/master/micro-app-vue-main/src/micro/apps.js#L20-L26</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> isProduction</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> process</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">env</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">NODE_ENV</span><span style="color:#56B6C2;"> ===</span><span style="color:#98C379;"> &#39;production&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> isEnter</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> isProduction</span><span style="color:#C678DD;"> ?</span><span style="color:#98C379;"> &#39;120.79.229.197&#39;</span><span style="color:#C678DD;"> :</span><span style="color:#98C379;"> &#39;localhost&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> genActiveRule</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">routerPrefix</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  // 返回 true 就激活了子应用</span></span>
<span class="line"><span style="color:#C678DD;">  return</span><span style="color:#E06C75;font-style:italic;"> location</span><span style="color:#C678DD;"> =&gt;</span><span style="color:#E5C07B;"> location</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">pathname</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">startsWith</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">routerPrefix</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> apps</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  /**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * name: 微应用名称 - 具有唯一性</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * entry: 微应用入口 - 通过该地址加载微应用</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * container: 微应用挂载节点 - 微应用加载完成后将挂载在该节点上</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * activeRule: 浏览器url发生变化会调用这个函数，activeRule 返回 true 时表明该子应用需要被激活。</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   * props 向子组件传递信息</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">   */</span></span>
<span class="line"><span style="color:#ABB2BF;">  {</span></span>
<span class="line"><span style="color:#E06C75;">    name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ReactMicroApp&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">    entry</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">`//</span><span style="color:#C678DD;">${</span><span style="color:#E06C75;">isEnter</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">:10100`</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">    container</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;#wrapper&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">    activeRule</span><span style="color:#ABB2BF;">: </span><span style="color:#61AFEF;">genActiveRule</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;/menu/react&quot;</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#E06C75;">    props</span><span style="color:#ABB2BF;">: {</span><span style="color:#E06C75;">data</span><span style="color:#ABB2BF;">:[]},</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#C678DD;">export</span><span style="color:#C678DD;"> default</span><span style="color:#E06C75;"> apps</span><span style="color:#ABB2BF;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>介入乾坤声明周期，错误捕获，导出启动函数</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// mic/micro-app-vue-main/src/micro/index.js</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// https://github.com/wkvictory/mic/blob/master/micro-app-vue-main/src/micro/index.js#L27</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> {</span><span style="color:#E06C75;">Notification</span><span style="color:#ABB2BF;">} </span><span style="color:#C678DD;">from</span><span style="color:#98C379;"> &#39;element-ui&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/*进度条插件*/</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#E06C75;"> NProgress</span><span style="color:#C678DD;"> from</span><span style="color:#98C379;"> &quot;nprogress&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#98C379;"> &quot;nprogress/nprogress.css&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">  registerMicroApps</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">  addGlobalUncaughtErrorHandler</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">  start</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">  removeGlobalUncaughtErrorHandler</span></span>
<span class="line"><span style="color:#ABB2BF;">} </span><span style="color:#C678DD;">from</span><span style="color:#98C379;"> &quot;qiankun&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/*子应用注册信息*/</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#E06C75;"> apps</span><span style="color:#C678DD;"> from</span><span style="color:#98C379;"> &quot;./apps&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * registerMicroApps</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * </span><span style="color:#C678DD;font-style:italic;">@param</span><span style="color:#E5C07B;font-style:italic;">  {array}</span><span style="color:#E06C75;font-style:italic;"> apps</span><span style="color:#7F848E;font-style:italic;"> - 必选，子应用的一些注册信息</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * </span><span style="color:#C678DD;font-style:italic;">@param</span><span style="color:#E5C07B;font-style:italic;">  {function}</span><span style="color:#E06C75;font-style:italic;"> lifeCycles</span><span style="color:#7F848E;font-style:italic;"> - 可选，全局的子应用生命周期钩子</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * </span><span style="color:#C678DD;font-style:italic;">@param</span><span style="color:#E5C07B;font-style:italic;">  {object}</span><span style="color:#E06C75;font-style:italic;"> opts</span><span style="color:#7F848E;font-style:italic;"> - 可选</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *            fetch - Function - 可选</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *            getPublicPath - (url: string) =&gt; string - 可选</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> *            getTemplate - (tpl: string) =&gt; string - 可选</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> */</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">registerMicroApps</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">apps</span><span style="color:#ABB2BF;">, {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  /*qiankun 生命周期钩子 - 加载前*/</span></span>
<span class="line"><span style="color:#61AFEF;">  beforeLoad</span><span style="color:#ABB2BF;">: (</span><span style="color:#E06C75;font-style:italic;">app</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // 加载子应用前，加载进度条</span></span>
<span class="line"><span style="color:#E5C07B;">    NProgress</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">start</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;">    NProgress</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">set</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0.4</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">    console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">`%c挂载前 </span><span style="color:#C678DD;">${</span><span style="color:#E5C07B;">app</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">`</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">`color:rgb(255, 208, 75);font-size:18px;`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">  },</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  /*qiankun 生命周期钩子 - 挂载后*/</span></span>
<span class="line"><span style="color:#61AFEF;">  afterMount</span><span style="color:#ABB2BF;">: (</span><span style="color:#E06C75;font-style:italic;">app</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // 加载子应用前，进度条加载完成</span></span>
<span class="line"><span style="color:#E5C07B;">    NProgress</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">done</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#E5C07B;">    console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">`%c挂载后 </span><span style="color:#C678DD;">${</span><span style="color:#E5C07B;">app</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">name</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">`</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">`color:rgb(255, 208, 75);font-size:18px`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#E5C07B;"> Promise</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">  },</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * 添加全局的未捕获异常处理器</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#61AFEF;">addGlobalUncaughtErrorHandler</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">event</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">  console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">event</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">  const</span><span style="color:#ABB2BF;"> {</span><span style="color:#E06C75;">message</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">msg</span><span style="color:#ABB2BF;">} </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> event</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  /*加载失败时提示*/</span></span>
<span class="line"><span style="color:#C678DD;">  if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">msg</span><span style="color:#56B6C2;"> &amp;&amp;</span><span style="color:#E5C07B;"> msg</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">includes</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;died in status LOADING_SOURCE_CODE&quot;</span><span style="color:#ABB2BF;">)) {</span></span>
<span class="line"><span style="color:#61AFEF;">    Notification</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#E06C75;">      title</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;加载失败&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">      message</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;子应用加载失败，请检查应用是否可运行&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">      type</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;error&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">    });</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">removeGlobalUncaughtErrorHandler</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">  console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;移除未捕获的错误&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">  return</span><span style="color:#D19A66;"> false</span></span>
<span class="line"><span style="color:#ABB2BF;">})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/*导出 qiankun 的启动函数*/</span></span>
<span class="line"><span style="color:#C678DD;">export</span><span style="color:#C678DD;"> default</span><span style="color:#E06C75;"> start</span><span style="color:#ABB2BF;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br></div></div><p>然后在mainJs里面启动该函数主应用的任务就完成了。</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// mic/micro-app-vue-main/src/main.js</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// https://github.com/wkvictory/mic/blob/master/micro-app-vue-main/src/main.js#L47</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#E06C75;"> startQiankun</span><span style="color:#C678DD;"> from</span><span style="color:#98C379;"> &quot;./micro&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/*</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">* prefetch  预渲染</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">* singular  是否为 单实例 场景</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">* jsSandbox 是否开启沙箱  关闭后兼容IE（但要承担关掉沙箱后子应用之间可能造成冲突的风险）</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">* fetch     自定义的fetch方法</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">* */</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">startQiankun</span><span style="color:#ABB2BF;">({</span><span style="color:#E06C75;">singular</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">prefetch</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;">});</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>到这一步，我们的主应用基座就创建好啦！</p><h3 id="接入子应用" tabindex="-1">接入子应用 <a class="header-anchor" href="#接入子应用" aria-label="Permalink to &quot;接入子应用&quot;">​</a></h3><p>首先，我们在 <code>React</code> 的入口文件 <code>index.js</code> 中，导出 <code>qiankun</code> 主应用所需要的三个生命周期钩子函数，代码实现如下：</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// mic/micro-app-react/src/index.jsx</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// https://github.com/wkvictory/mic/blob/master/micro-app-react/src/index.js#L46</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#E06C75;"> React</span><span style="color:#C678DD;"> from</span><span style="color:#98C379;"> &#39;react&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#E06C75;"> ReactDOM</span><span style="color:#C678DD;"> from</span><span style="color:#98C379;"> &#39;react-dom&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#98C379;"> &#39;./index.css&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#E06C75;"> App</span><span style="color:#C678DD;"> from</span><span style="color:#98C379;"> &#39;./App&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> {</span><span style="color:#E06C75;">ConfigProvider</span><span style="color:#ABB2BF;">} </span><span style="color:#C678DD;">from</span><span style="color:#98C379;"> &#39;antd&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#E06C75;"> zhCN</span><span style="color:#C678DD;"> from</span><span style="color:#98C379;"> &#39;antd/es/locale/zh_CN&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#98C379;"> &#39;moment/locale/zh-cn&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * 渲染函数</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * 两种情况：主应用生命周期钩子中运行 / 微应用单独启动时运行</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> render</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#E5C07B;">  ReactDOM</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">render</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E5C07B;">ConfigProvider</span></span>
<span class="line"><span style="color:#D19A66;font-style:italic;">      autoInsertSpaceInButton</span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;">{</span><span style="color:#D19A66;">true</span><span style="color:#C678DD;">}</span></span>
<span class="line"><span style="color:#D19A66;font-style:italic;">      locale</span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;">{</span><span style="color:#E06C75;">zhCN</span><span style="color:#C678DD;">}</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">      &lt;</span><span style="color:#E5C07B;">App</span><span style="color:#ABB2BF;">/&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;/</span><span style="color:#E5C07B;">ConfigProvider</span><span style="color:#ABB2BF;">&gt;,</span></span>
<span class="line"><span style="color:#E5C07B;">    document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getElementById</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;root&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">  );</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 独立运行时，直接挂载应用</span></span>
<span class="line"><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">!</span><span style="color:#E5C07B;">window</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">__POWERED_BY_QIANKUN__</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#61AFEF;">  render</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * bootstrap 只会在微应用初始化的时候调用一次，下次微应用重新进入时会直接调用 mount 钩子，不会再重复触发 bootstrap。</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * 通常我们可以在这里做一些全局变量的初始化，比如不会在 unmount 阶段被销毁的应用级别的缓存等。</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#C678DD;">export</span><span style="color:#C678DD;"> async</span><span style="color:#C678DD;"> function</span><span style="color:#61AFEF;"> bootstrap</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#E5C07B;">  console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ReactMicroApp bootstraped&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * 应用每次进入都会调用 mount 方法，通常我们在这里触发应用的渲染方法</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * props 是注册的时候传进来的</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#C678DD;">export</span><span style="color:#C678DD;"> async</span><span style="color:#C678DD;"> function</span><span style="color:#61AFEF;"> mount</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">props</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">  console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;ReactMicroApp mount&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">props</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#61AFEF;">  render</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">props</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> * 应用每次 切出/卸载 会调用的方法，通常在这里我们会卸载微应用的应用实例</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#C678DD;">export</span><span style="color:#C678DD;"> async</span><span style="color:#C678DD;"> function</span><span style="color:#61AFEF;"> unmount</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#E5C07B;">  console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;销毁&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">  ReactDOM</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">unmountComponentAtNode</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getElementById</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;root&quot;</span><span style="color:#ABB2BF;">));</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br></div></div><p>在配置好了入口文件 <code>index.js</code> 后，我们还需要配置路由命名空间，以确保主应用可以正确加载微应用，代码实现如下：</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// mic/micro-app-react/src/app.jsx</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// https://github.com/wkvictory/mic/blob/master/micro-app-react/src/App.js#L11</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#E06C75;"> React</span><span style="color:#C678DD;"> from</span><span style="color:#98C379;"> &#39;react&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ....</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> BASE_NAME</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> window</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">__POWERED_BY_QIANKUN__</span><span style="color:#C678DD;"> ?</span><span style="color:#98C379;"> &quot;/menu/react&quot;</span><span style="color:#C678DD;"> :</span><span style="color:#98C379;"> &quot;&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> App</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#C678DD;">  return</span><span style="color:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E5C07B;">Provider</span><span style="color:#D19A66;font-style:italic;"> store</span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;">{</span><span style="color:#E06C75;">store</span><span style="color:#C678DD;">}</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">      &lt;</span><span style="color:#E5C07B;">Router</span><span style="color:#D19A66;font-style:italic;"> basename</span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;">{</span><span style="color:#E5C07B;">BASE_NAME</span><span style="color:#C678DD;">}</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">        &lt;</span><span style="color:#E5C07B;">Switch</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#C678DD;">          {</span><span style="color:#61AFEF;">renderRoutes</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">routes</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">routes</span><span style="color:#ABB2BF;">)</span><span style="color:#C678DD;">}</span></span>
<span class="line"><span style="color:#ABB2BF;">        &lt;/</span><span style="color:#E5C07B;">Switch</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">      &lt;/</span><span style="color:#E5C07B;">Router</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;/</span><span style="color:#E5C07B;">Provider</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">  );</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#C678DD;">export</span><span style="color:#C678DD;"> default</span><span style="color:#E06C75;"> App</span><span style="color:#ABB2BF;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>接下来要配置webpack</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> path</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> require</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;path&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> packageName</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> require</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;./package.json&#39;</span><span style="color:#ABB2BF;">).</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">module</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">exports</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">  webpack</span><span style="color:#ABB2BF;">: (</span><span style="color:#E06C75;font-style:italic;">config</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // https://webpack.js.org/configuration/output/#outputlibrary</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // 微应用的包名，这里与主应用中注册的微应用名称一致</span></span>
<span class="line"><span style="color:#E5C07B;">    config</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">output</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">library</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> `</span><span style="color:#C678DD;">${</span><span style="color:#E06C75;">packageName</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">App`</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // 将你的 library 暴露为所有的模块定义下都可运行的方式</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // https://zhuanlan.zhihu.com/p/71168066</span></span>
<span class="line"><span style="color:#E5C07B;">    config</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">output</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">libraryTarget</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &quot;umd&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // (懒加载)使异步加载的模块在多个不同的bundle内同步，设置为 webpackJsonp_VueMicroApp 即可</span></span>
<span class="line"><span style="color:#E5C07B;">    config</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">output</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">jsonpFunction</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> `webpackJsonp_</span><span style="color:#C678DD;">${</span><span style="color:#E06C75;">packageName</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">App`</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">    config</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">resolve</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">alias</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">      ...</span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">resolve</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">alias</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#98C379;">      &quot;@&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">path</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">__dirname</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;src&quot;</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;">    };</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#E06C75;"> config</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  },</span></span>
<span class="line"><span style="color:#61AFEF;">  devServer</span><span style="color:#ABB2BF;">: </span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">configFunction</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#C678DD;"> function</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">proxy</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">allowedHost</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">      const</span><span style="color:#E5C07B;"> config</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> configFunction</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">proxy</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">allowedHost</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">      // 关闭主机检查，使微应用可以被 fetch</span></span>
<span class="line"><span style="color:#E5C07B;">      config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">disableHostCheck</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> true</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">      // 配置跨域请求头，解决开发环境的跨域问题</span></span>
<span class="line"><span style="color:#E5C07B;">      config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">headers</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#98C379;">        &quot;Access-Control-Allow-Origin&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;*&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">      };</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">      // 配置 history 模式</span></span>
<span class="line"><span style="color:#E5C07B;">      config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">historyApiFallback</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> true</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E5C07B;">      config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">hot</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> true</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#E5C07B;">      config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">open</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> false</span><span style="color:#ABB2BF;">;  </span><span style="color:#7F848E;font-style:italic;">// 子应用设置false</span></span>
<span class="line"><span style="color:#C678DD;">      return</span><span style="color:#E06C75;"> config</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    };</span></span>
<span class="line"><span style="color:#ABB2BF;">  },</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>我们需要重点关注一下 <code>output</code> 选项，当我们把 <code>libraryTarget</code> 设置为 <code>umd</code> 后，我们的 <code>library</code> 就暴露为所有的模块定义下都可运行的方式了，主应用就可以获取到微应用的生命周期钩子函数了。</p><p>到这里，<code>React</code> 微应用就接入成功了！其他的技术栈接入方式大同小异，不在一一列举，具体看下方github。</p><h2 id="通信" tabindex="-1">通信 <a class="header-anchor" href="#通信" aria-label="Permalink to &quot;通信&quot;">​</a></h2><p><strong>示例：子应用跳转到另一个子应用（通过主应用做媒介）</strong></p><h3 id="基于浏览器原生事件做通信" tabindex="-1">基于浏览器原生事件做通信 <a class="header-anchor" href="#基于浏览器原生事件做通信" aria-label="Permalink to &quot;基于浏览器原生事件做通信&quot;">​</a></h3><p><a href="http://wkdevhub.cn/2020/08/28/workspace/Js/dispatchEvent/" target="_blank" rel="noreferrer">CustomEvent API 详情</a></p><p><strong>父应用</strong></p><p>首先，我们在主应用中初始化CustomEvent，挂载到window上，然后添加我们要传递的值：</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// mic/micro-app-vue-main/src/app.vue</span></span>
<span class="line"><span style="color:#C678DD;">export</span><span style="color:#C678DD;"> default</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">   mounted</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#C678DD;">      function</span><span style="color:#61AFEF;"> createEvent</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">params</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">eventName</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;emit&#39;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        // 数据必须挂载到detail上</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> CustomEvent</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">eventName</span><span style="color:#ABB2BF;">, {</span><span style="color:#E06C75;">detail</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;">params</span><span style="color:#ABB2BF;">});</span></span>
<span class="line"><span style="color:#ABB2BF;">      }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">      // 初始化</span></span>
<span class="line"><span style="color:#E5C07B;">      window</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">cEvt</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> createEvent</span><span style="color:#ABB2BF;">({</span><span style="color:#E06C75;">handelData</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">handelData</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">jumpUrl</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">jumpUrl</span><span style="color:#ABB2BF;">});</span></span>
<span class="line"><span style="color:#ABB2BF;">    },</span></span>
<span class="line"><span style="color:#E06C75;">    methods</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#61AFEF;">      handelData</span><span style="color:#ABB2BF;">(...</span><span style="color:#E06C75;font-style:italic;">opt</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        // 为了避免重新渲染 obj 可以放到外面声明</span></span>
<span class="line"><span style="color:#E5C07B;">        this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">obj</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Object</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">assign</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">obj</span><span style="color:#ABB2BF;">, ...</span><span style="color:#E06C75;">opt</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">obj</span></span>
<span class="line"><span style="color:#ABB2BF;">      },</span></span>
<span class="line"><span style="color:#61AFEF;">      jumpUrl</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">url</span><span style="color:#ABB2BF;">){</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        // 跳转</span></span>
<span class="line"><span style="color:#E5C07B;">        this</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">$router</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">history</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">url</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">      }</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p><strong>子应用</strong></p><p>然后子应用在函数中添加事件监听，执行跳转操作触发事件</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// mic/micro-app-react/src/pages/detail/index.jsx</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#E06C75;"> React</span><span style="color:#ABB2BF;">, {</span><span style="color:#E06C75;">Fragment</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">useEffect</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">useRef</span><span style="color:#ABB2BF;">} </span><span style="color:#C678DD;">from</span><span style="color:#98C379;"> &quot;react&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> Index</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">props</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">  let</span><span style="color:#E06C75;"> msgRef</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> useRef</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">null</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">  useEffect</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">    document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addEventListener</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;emit&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">queryData</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> () </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">      // 移除事件监听器</span></span>
<span class="line"><span style="color:#E5C07B;">      document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">removeEventListener</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;emit&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">queryData</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">  }, [])</span></span>
<span class="line"><span style="color:#C678DD;">  const</span><span style="color:#61AFEF;"> queryData</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> ({</span><span style="color:#E06C75;">detail</span><span style="color:#ABB2BF;">: {</span><span style="color:#E06C75;font-style:italic;">handelData</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">jumpUrl</span><span style="color:#ABB2BF;">}}) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">    console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">handelData</span><span style="color:#ABB2BF;">({</span><span style="color:#E06C75;">msg</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">msgRef</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">current</span><span style="color:#ABB2BF;">}));</span></span>
<span class="line"><span style="color:#61AFEF;">    jumpUrl</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;/menu/vue/list&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#C678DD;">  const</span><span style="color:#61AFEF;"> dispatchData</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">msg</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> () </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">    msgRef</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">current</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> msg</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    /* 触发自定义事件 通信*/</span></span>
<span class="line"><span style="color:#E5C07B;">    document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">dispatchEvent</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">window</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">cEvt</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#C678DD;">  return</span><span style="color:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E5C07B;">Fragment</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">       &lt;</span><span style="color:#E06C75;">h2</span><span style="color:#D19A66;font-style:italic;"> onClick</span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;">{</span><span style="color:#61AFEF;">dispatchData</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;wk&#39;</span><span style="color:#ABB2BF;">)</span><span style="color:#C678DD;">}</span><span style="color:#ABB2BF;">&gt;跳转&lt;/</span><span style="color:#E06C75;">h2</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;/</span><span style="color:#E5C07B;">Fragment</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">  )</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">export</span><span style="color:#C678DD;"> default</span><span style="color:#E06C75;"> Index</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p><strong>别忘了移除事件监听器</strong></p><p>为了防止子应用独立运行的时候报错需要在子应用加载的时候加上错误提示。</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// mic/micro-app-react/src/index.jsx</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 独立运行时，直接挂载应用</span></span>
<span class="line"><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">!</span><span style="color:#E5C07B;">window</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">__POWERED_BY_QIANKUN__</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">  function</span><span style="color:#61AFEF;"> createEvent</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">params</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">eventName</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;emit&#39;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> CustomEvent</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">eventName</span><span style="color:#ABB2BF;">, {</span><span style="color:#E06C75;">detail</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;">params</span><span style="color:#ABB2BF;">});</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">  window</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">cEvt</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> createEvent</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#61AFEF;">    handelData</span><span style="color:#ABB2BF;">: () </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;不能运行&#39;</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#61AFEF;">    jumpUrl</span><span style="color:#ABB2BF;">: () </span><span style="color:#C678DD;">=&gt;</span><span style="color:#E5C07B;"> console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;不能运行&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">  })</span></span>
<span class="line"><span style="color:#61AFEF;">  render</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>这种优势就是纯原生方便包装，使用简单，适合简单的通信。</p><h3 id="基于qiankun提供的api" tabindex="-1">基于qiankun提供的API <a class="header-anchor" href="#基于qiankun提供的api" aria-label="Permalink to &quot;基于qiankun提供的API&quot;">​</a></h3><p><code>qiankun</code> 内部提供了 <code>initGlobalState</code> 方法用于注册 <code>MicroAppStateActions</code> 实例用于通信，该实例有三个方法，分别是：</p><ul><li><code>setGlobalState</code>：设置 <code>globalState</code> - 设置新的值时，内部将执行 <code>浅检查</code>，如果检查到 <code>globalState</code> 发生改变则触发通知，通知到所有的 <code>观察者</code> 函数。</li><li><code>onGlobalStateChange</code>：注册 <code>观察者</code> 函数 - 响应 <code>globalState</code> 变化，在 <code>globalState</code> 发生改变时触发该 <code>观察者</code> 函数。</li><li><code>offGlobalStateChange</code>：取消 <code>观察者</code> 函数 - 该实例不再响应 <code>globalState</code> 变化</li></ul><p><strong>主应用</strong></p><p>首先，我们在主应用中注册一个 <code>MicroAppStateActions</code> 实例并导出，代码实现如下：</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// mic/micro-app-vue-main/src/shared/actions.ts</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> {</span><span style="color:#E06C75;">initGlobalState</span><span style="color:#ABB2BF;">} </span><span style="color:#C678DD;">from</span><span style="color:#98C379;"> &quot;qiankun&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#E06C75;"> router</span><span style="color:#C678DD;"> from</span><span style="color:#98C379;"> &#39;@/router&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> initialState</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">  jumpUrl</span><span style="color:#ABB2BF;">: (</span><span style="color:#E06C75;font-style:italic;">url</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">    router</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">history</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">url</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> actions</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> initGlobalState</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">initialState</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">export</span><span style="color:#C678DD;"> default</span><span style="color:#E06C75;"> actions</span><span style="color:#ABB2BF;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>在注册 <code>MicroAppStateActions</code> 实例后，我们在需要通信的组件中使用该实例，并注册 <code>观察者</code> 函数</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// mic/micro-app-vue-main/src/app.vue</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#E06C75;"> actions</span><span style="color:#C678DD;"> from</span><span style="color:#98C379;"> &quot;@/shared/actions&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">export</span><span style="color:#C678DD;"> default</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">   mounted</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#E5C07B;">     actions</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">onGlobalStateChange</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">state</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">prevState</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        // state: 变更后的状态; prevState: 变更前的状态</span></span>
<span class="line"><span style="color:#E5C07B;">        console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;主应用观察者：改变前的 &quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">prevState</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">        console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;主应用观察者：改变后的 &quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">state</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">      }, </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">     // 第二个参数表示立即执行</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><strong>子应用</strong></p><p>我们首先来改造我们的 <code>Vue</code> 子应用，首先我们设置一个 <code>Actions</code> 实例，代码实现如下：</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// mic/micro-app-vue-main/src/shared/actions.js</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> emptyAction</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> () </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">  console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">warn</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;当前执行的actions为空!&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#E5C07B;"> Actions</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  // 默认值为空 Action</span></span>
<span class="line"><span style="color:#E06C75;">  actions</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">    onGlobalStateChange</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;">emptyAction</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">    setGlobalState</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;">emptyAction</span></span>
<span class="line"><span style="color:#ABB2BF;">  };</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  // 设置 actions</span></span>
<span class="line"><span style="color:#61AFEF;">  setActions</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">actions</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">    this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">actions</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> actions</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  // 映射</span></span>
<span class="line"><span style="color:#61AFEF;">  onGlobalStateChange</span><span style="color:#ABB2BF;">(...</span><span style="color:#E06C75;font-style:italic;">args</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">actions</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">onGlobalStateChange</span><span style="color:#ABB2BF;">(...</span><span style="color:#E06C75;">args</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  // 映射</span></span>
<span class="line"><span style="color:#61AFEF;">  setGlobalState</span><span style="color:#ABB2BF;">(...</span><span style="color:#E06C75;font-style:italic;">args</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">actions</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">setGlobalState</span><span style="color:#ABB2BF;">(...</span><span style="color:#E06C75;">args</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> actions</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> Actions</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#C678DD;">export</span><span style="color:#C678DD;"> default</span><span style="color:#E06C75;"> actions</span><span style="color:#ABB2BF;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>我们创建 <code>actions</code> 实例后，我们需要为其注入真实 <code>Actions</code>。我们在入口文件 <code>main.js</code> 的 <code>render</code> 函数中注入，代码实现如下：</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// mic/micro-app-vue-main/src/main.js</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> render</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">props</span><span style="color:#ABB2BF;">) { </span><span style="color:#7F848E;font-style:italic;">// mount方法传递进来的</span></span>
<span class="line"><span style="color:#C678DD;">  if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">props</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // 注入 actions 实例, 不需要在入口额外引入，乾坤自己集成的</span></span>
<span class="line"><span style="color:#E5C07B;">    actions</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">setActions</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">props</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#E06C75;">  router</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> VueRouter</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // 运行在主应用中时，添加路由命名空间 /vue</span></span>
<span class="line"><span style="color:#E06C75;">    base</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">window</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">__POWERED_BY_QIANKUN__</span><span style="color:#C678DD;"> ?</span><span style="color:#98C379;"> &quot;/menu/vue&quot;</span><span style="color:#C678DD;"> :</span><span style="color:#98C379;"> &quot;/&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">    mode</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;history&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">    routes</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">  });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> // 解决ElementUI导航栏中的vue-router在3.0版本以上重复点菜单报错问题</span></span>
<span class="line"><span style="color:#C678DD;">  const</span><span style="color:#E5C07B;"> originalPush</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> VueRouter</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">push</span></span>
<span class="line"><span style="color:#E5C07B;">  VueRouter</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">prototype</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">push</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> function</span><span style="color:#61AFEF;"> push</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">location</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#E5C07B;"> originalPush</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">call</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">location</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">err</span><span style="color:#C678DD;"> =&gt;</span><span style="color:#E06C75;"> err</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  // 挂载应用</span></span>
<span class="line"><span style="color:#E06C75;">  instance</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> Vue</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#E06C75;">    router</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">    store</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#61AFEF;">    render</span><span style="color:#ABB2BF;">: (</span><span style="color:#E06C75;font-style:italic;">h</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#61AFEF;"> h</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">App</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;">  }).</span><span style="color:#61AFEF;">$mount</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;#app&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>然后在列表页引入当前的actions，执行跳转的方法:</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// /mic/micro-app-vue/src/shared/actions.js</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#E06C75;"> actions</span><span style="color:#C678DD;"> from</span><span style="color:#98C379;"> &quot;@/shared/actions&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#C678DD;">export</span><span style="color:#C678DD;"> default</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">    data</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#C678DD;">      return</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">        jumpUrl</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">null</span></span>
<span class="line"><span style="color:#ABB2BF;">      }</span></span>
<span class="line"><span style="color:#ABB2BF;">    },</span></span>
<span class="line"><span style="color:#E06C75;">    inject</span><span style="color:#ABB2BF;">: [</span><span style="color:#98C379;">&quot;reload&quot;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#61AFEF;">    created</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#E5C07B;">      this</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">$nextTick</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">queryList</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    },</span></span>
<span class="line"><span style="color:#61AFEF;">    mounted</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#E5C07B;">      actions</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">onGlobalStateChange</span><span style="color:#ABB2BF;">((</span><span style="color:#E06C75;font-style:italic;">state</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">        this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">jumpUrl</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> state</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">jumpUrl</span></span>
<span class="line"><span style="color:#ABB2BF;">      }, </span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    },</span></span>
<span class="line"><span style="color:#E06C75;">    methods</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#61AFEF;">      jumpReactDetail</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">options</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">        this</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">jumpUrl</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">`/menu/react/detail/</span><span style="color:#C678DD;">${</span><span style="color:#E5C07B;">options</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">id</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">`</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">      }</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>这种的优势就是轻量，官方自带，适合业务划分清晰，比较简单的微前端应用</p><h3 id="基于redux" tabindex="-1">基于redux <a class="header-anchor" href="#基于redux" aria-label="Permalink to &quot;基于redux&quot;">​</a></h3><p>基于 <code>qiankun</code> 提供的通信方案也存在一些优缺点，优点如下：</p><ol><li>使用简单；</li><li>官方支持性高；</li><li>适合通信较少的业务场景；</li></ol><p>缺点如下：</p><ol><li>子应用独立运行时，需要额外配置无 <code>qiankun</code> 时的逻辑； redux 版可以直接引入且独立运行。</li><li>由于状态池无法跟踪，通信场景较多时，容易出现状态混乱、维护困难等问题；</li></ol><p><strong>父应用</strong></p><p>首先我们需要在主应用中创建 <code>store</code> 用于管理全局状态池</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// mic/micro-app-vue-main/src/shared/store.js</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> {</span><span style="color:#E06C75;">createStore</span><span style="color:#ABB2BF;">} </span><span style="color:#C678DD;">from</span><span style="color:#98C379;"> &quot;redux&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#E06C75;"> router</span><span style="color:#C678DD;"> from</span><span style="color:#98C379;"> &#39;@/router&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> initialState</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">  jumpUrl</span><span style="color:#ABB2BF;">: (</span><span style="color:#E06C75;font-style:italic;">url</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">    router</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">history</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">push</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">url</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">  },</span></span>
<span class="line"><span style="color:#E06C75;">  detail</span><span style="color:#ABB2BF;">: {}</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 多个reducer用combineReducers合并</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> reducer</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">state</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> initialState</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">action</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">  switch</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">action</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">type</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">    default</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">      return</span><span style="color:#E06C75;"> state</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">    case</span><span style="color:#98C379;"> &quot;SET_DETAIL&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#C678DD;">      return</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">        ...</span><span style="color:#E06C75;">state</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">        detail</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">action</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">payload</span></span>
<span class="line"><span style="color:#ABB2BF;">      };</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> store</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> createStore</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">reducer</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">export</span><span style="color:#C678DD;"> default</span><span style="color:#E06C75;"> store</span><span style="color:#ABB2BF;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>然后，我们需要将 <code>store</code> 实例通过 <code>props</code> 传递给子应用，代码实现如下：</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// mic/micro-app-vue-main/src/micro/app.js</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#E06C75;"> store</span><span style="color:#C678DD;"> from</span><span style="color:#98C379;"> &quot;@/shared/store&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> apps</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> [</span></span>
<span class="line"><span style="color:#ABB2BF;">  {</span></span>
<span class="line"><span style="color:#E06C75;">    name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;ReactMicroApp&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">    entry</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">`//</span><span style="color:#C678DD;">${</span><span style="color:#E06C75;">isEnter</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">:10100`</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">    container</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;#wrapper&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">    activeRule</span><span style="color:#ABB2BF;">: </span><span style="color:#61AFEF;">genActiveRule</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;/menu/react&quot;</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // 通过 props 将 shared 传递给子应用</span></span>
<span class="line"><span style="color:#E06C75;">    props</span><span style="color:#ABB2BF;">: {</span><span style="color:#E06C75;">store</span><span style="color:#ABB2BF;">},</span></span>
<span class="line"><span style="color:#ABB2BF;">  },</span></span>
<span class="line"><span style="color:#ABB2BF;">  {</span></span>
<span class="line"><span style="color:#E06C75;">    name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;VueMicroApp&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">    entry</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">`//</span><span style="color:#C678DD;">${</span><span style="color:#E06C75;">isEnter</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">:10200`</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">    container</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;#wrapper&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">    activeRule</span><span style="color:#ABB2BF;">: </span><span style="color:#61AFEF;">genActiveRule</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;/menu/vue&quot;</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#E06C75;">    props</span><span style="color:#ABB2BF;">: {</span><span style="color:#E06C75;">store</span><span style="color:#ABB2BF;">},</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#ABB2BF;">];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">export</span><span style="color:#C678DD;"> default</span><span style="color:#E06C75;"> apps</span><span style="color:#ABB2BF;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p><strong>子应用</strong></p><p>子应用一般会有自己的状态管理，主应用通信的也不多，所以直接简单处理提示下就行了。</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// mic/micro-app-react/src/shared/store.js</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> emptyRedux</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> () </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">  console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">warn</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;当前执行的redux不存在!&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#E5C07B;"> Store</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">  actions</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">    dispatch</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;">emptyRedux</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">    getState</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;">emptyRedux</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">    replaceReducer</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;">emptyRedux</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">    subscribe</span><span style="color:#ABB2BF;">: </span><span style="color:#E06C75;">emptyRedux</span></span>
<span class="line"><span style="color:#ABB2BF;">  };</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  // 重载</span></span>
<span class="line"><span style="color:#61AFEF;">  setStore</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">actions</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">    this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">actions</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> actions</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">  dispatch</span><span style="color:#ABB2BF;">(...</span><span style="color:#E06C75;font-style:italic;">args</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">actions</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">dispatch</span><span style="color:#ABB2BF;">(...</span><span style="color:#E06C75;">args</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">  getState</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">actions</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getState</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">||</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">      jumpUrl</span><span style="color:#ABB2BF;">: () </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {} </span><span style="color:#7F848E;font-style:italic;">// 这里redux传进来的方法，不然子应用单独打开运行会报错</span></span>
<span class="line"><span style="color:#ABB2BF;">    };</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">  replaceReducer</span><span style="color:#ABB2BF;">(...</span><span style="color:#E06C75;font-style:italic;">args</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">actions</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">replaceReducer</span><span style="color:#ABB2BF;">(...</span><span style="color:#E06C75;">args</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">  subscribe</span><span style="color:#ABB2BF;">(...</span><span style="color:#E06C75;font-style:italic;">args</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#E5C07B;"> this</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">actions</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">subscribe</span><span style="color:#ABB2BF;">(...</span><span style="color:#E06C75;">args</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> store</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> Store</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#C678DD;">export</span><span style="color:#C678DD;"> default</span><span style="color:#E06C75;"> store</span><span style="color:#ABB2BF;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>然后在入口文件处注入<code>store</code></p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// mic/micro-app-react/src/pages/app.jsx</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#E06C75;"> React</span><span style="color:#C678DD;"> from</span><span style="color:#98C379;"> &#39;react&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#E06C75;"> ReactDOM</span><span style="color:#C678DD;"> from</span><span style="color:#98C379;"> &#39;react-dom&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> render</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">props</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">  if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">props</span><span style="color:#56B6C2;"> &amp;&amp;</span><span style="color:#E5C07B;"> props</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">store</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // 注入redux 实例</span></span>
<span class="line"><span style="color:#E5C07B;">    store</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">setStore</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">props</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">store</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#E5C07B;">  ReactDOM</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">render</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">      &lt;</span><span style="color:#E5C07B;">App</span><span style="color:#ABB2BF;">/&gt;,</span></span>
<span class="line"><span style="color:#E5C07B;">    document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getElementById</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;root&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">  );</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>然后在项目中就可以直接引入使用了</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// mic/micro-app-react/src/pages/detail/index.jsx</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#E06C75;"> React</span><span style="color:#ABB2BF;">, {</span><span style="color:#E06C75;">Fragment</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">useEffect</span><span style="color:#ABB2BF;">} </span><span style="color:#C678DD;">from</span><span style="color:#98C379;"> &quot;react&quot;</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#E06C75;"> store</span><span style="color:#C678DD;"> from</span><span style="color:#98C379;"> &quot;@/shared/store&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#61AFEF;"> Index</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;">props</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">  useEffect</span><span style="color:#ABB2BF;">(()</span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // 返回值是取消订阅</span></span>
<span class="line"><span style="color:#C678DD;">    const</span><span style="color:#E5C07B;"> unSubscribe</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> store</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">subscribe</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">      // 注册订阅函数</span></span>
<span class="line"><span style="color:#E5C07B;">      console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">store</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getState</span><span style="color:#ABB2BF;">(), </span><span style="color:#98C379;">&#39;订阅方法&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    })</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#ABB2BF;"> ()</span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#61AFEF;">      unSubscribe</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">  },[])</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span></span>
<span class="line"><span style="color:#C678DD;">  const</span><span style="color:#61AFEF;"> dispatchRedux</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> () </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">    store</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">dispatch</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#E06C75;">      type</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;SET_DETAIL&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;">      payload</span><span style="color:#ABB2BF;">: {</span><span style="color:#E06C75;">data</span><span style="color:#ABB2BF;">: [</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;">kkk</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">121</span><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#ABB2BF;">    });</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#C678DD;">  const</span><span style="color:#61AFEF;"> jumpUrl</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> () </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E5C07B;">    store</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getState</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">jumpUrl</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;/menu/vue/table-detail&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#C678DD;">  return</span><span style="color:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E5C07B;">Fragment</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">       &lt;</span><span style="color:#E06C75;">h2</span><span style="color:#D19A66;font-style:italic;"> onClick</span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;">{</span><span style="color:#E06C75;">jumpUrl</span><span style="color:#C678DD;">}</span><span style="color:#ABB2BF;">&gt;跳转&lt;/</span><span style="color:#E06C75;">h2</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">			 &lt;</span><span style="color:#E06C75;">h2</span><span style="color:#D19A66;font-style:italic;"> onClick</span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;">{</span><span style="color:#E06C75;">dispatchRedux</span><span style="color:#C678DD;">}</span><span style="color:#ABB2BF;">&gt;修改&lt;/</span><span style="color:#E06C75;">h2</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;/</span><span style="color:#E5C07B;">Fragment</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">  )</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">export</span><span style="color:#C678DD;"> default</span><span style="color:#E06C75;"> Index</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>这种的优势就是避免状态随意污染，而且redux提供状态跟踪的插件，适合较为复杂的微前端应用。</p><h2 id="项目部署" tabindex="-1">项目部署 <a class="header-anchor" href="#项目部署" aria-label="Permalink to &quot;项目部署&quot;">​</a></h2><p>由于 qiankun 是通过 fetch 去获取子应用的引入的静态资源的，所以必须要求这些静态资源支持跨域</p><p>如果是自己的脚本，可以通过开发服务端跨域来支持。如果是三方脚本且无法为其添加跨域头，可以将脚本拖到本地，由自己的服务器 serve 来支持跨域。</p><p><strong>子应用nginx处添加 Access-Control-Allow-Origin，如果不想设置 ‘*’，也可以指定对多个ip开放中间逗号隔开就好。</strong></p><p><strong>需要注意的一个有关CORS的点：</strong></p><blockquote><p>对于附带身份凭证的请求(即服务器设置<strong>Access-Control-Allow-Credentials: true</strong>)，服务器不得设置 Access-Control-Allow-Origin 的值为“*”，则请求将会失败(不能携带cookie)。</p></blockquote><div class="language-nginx line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">server</span></span>
<span class="line"><span style="color:#ABB2BF;">        {</span></span>
<span class="line"><span style="color:#ABB2BF;">        listen </span><span style="color:#D19A66;">10200</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;"># 监听端口</span></span>
<span class="line"><span style="color:#C678DD;">        server_name </span><span style="color:#D19A66;">120.79.229.197</span><span style="color:#ABB2BF;"> ; </span><span style="color:#7F848E;font-style:italic;"># 请求到达的服务器名</span></span>
<span class="line"><span style="color:#C678DD;">        index </span><span style="color:#ABB2BF;">index.html index.htm index.php default.html default.htm default.php;</span></span>
<span class="line"><span style="color:#C678DD;">        root </span><span style="color:#ABB2BF;">/home/wwwroot/mic200.wkdevhub.cn/dist; </span><span style="color:#7F848E;font-style:italic;"># 指定运行路径</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span></span>
<span class="line"><span style="color:#C678DD;">        location</span><span style="color:#ABB2BF;"> / {</span></span>
<span class="line"><span style="color:#C678DD;">            try_files </span><span style="color:#ABB2BF;">$</span><span style="color:#E06C75;">uri</span><span style="color:#ABB2BF;"> $</span><span style="color:#E06C75;">uri</span><span style="color:#ABB2BF;">/ /index.html; </span><span style="color:#7F848E;font-style:italic;"># 重定向</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> ($</span><span style="color:#E06C75;">request_method</span><span style="color:#ABB2BF;"> = </span><span style="color:#98C379;">&#39;OPTIONS&#39;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">              add_header </span><span style="color:#98C379;">&#39;Access-Control-Allow-Origin&#39;</span><span style="color:#98C379;"> &#39;*&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">              add_header </span><span style="color:#98C379;">&#39;Access-Control-Allow-Methods&#39;</span><span style="color:#98C379;"> &#39;GET, POST, OPTIONS&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">              add_header </span><span style="color:#98C379;">&#39;Access-Control-Allow-Headers&#39;</span></span>
<span class="line"><span style="color:#98C379;">              &#39;DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">              add_header </span><span style="color:#98C379;">&#39;Access-Control-Max-Age&#39;</span><span style="color:#D19A66;"> 1728000</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">              add_header </span><span style="color:#98C379;">&#39;Content-Type&#39;</span><span style="color:#98C379;"> &#39;text/plain charset=UTF-8&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">              add_header </span><span style="color:#98C379;">&#39;Content-Length&#39;</span><span style="color:#D19A66;"> 0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">              return</span><span style="color:#D19A66;"> 204</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">            }</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> ($</span><span style="color:#E06C75;">request_method</span><span style="color:#ABB2BF;"> = </span><span style="color:#98C379;">&#39;POST&#39;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">              add_header </span><span style="color:#98C379;">&#39;Access-Control-Allow-Origin&#39;</span><span style="color:#98C379;"> &#39;*&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">              add_header </span><span style="color:#98C379;">&#39;Access-Control-Allow-Methods&#39;</span><span style="color:#98C379;"> &#39;GET, POST, OPTIONS&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">              add_header </span><span style="color:#98C379;">&#39;Access-Control-Allow-Headers&#39;</span></span>
<span class="line"><span style="color:#98C379;">              &#39;DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">            }</span></span>
<span class="line"><span style="color:#C678DD;">            if</span><span style="color:#ABB2BF;"> ($</span><span style="color:#E06C75;">request_method</span><span style="color:#ABB2BF;"> = </span><span style="color:#98C379;">&#39;GET&#39;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">              add_header </span><span style="color:#98C379;">&#39;Access-Control-Allow-Origin&#39;</span><span style="color:#98C379;"> &#39;*&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">              add_header </span><span style="color:#98C379;">&#39;Access-Control-Allow-Methods&#39;</span><span style="color:#98C379;"> &#39;GET, POST, OPTIONS&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">              add_header </span><span style="color:#98C379;">&#39;Access-Control-Allow-Headers&#39;</span></span>
<span class="line"><span style="color:#98C379;">              &#39;DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">            }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        include </span><span style="color:#ABB2BF;">rewrite/none.conf;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        include </span><span style="color:#ABB2BF;">enable-php.conf;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        location</span><span style="color:#ABB2BF;"> ~ .*\.(gif|jpg|jpeg|png|bmp|swf)$</span></span>
<span class="line"><span style="color:#ABB2BF;">        {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # 静态图片 允许跨域请求</span></span>
<span class="line"><span style="color:#C678DD;">            add_header </span><span style="color:#ABB2BF;">Access-Control-Allow-Origin </span><span style="color:#98C379;">&#39;*&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">            add_header </span><span style="color:#ABB2BF;">Access-Control-Allow-Headers X-Requested-With;</span></span>
<span class="line"><span style="color:#C678DD;">            add_header </span><span style="color:#ABB2BF;">Access-Control-Allow-Methods GET,POST,OPTIONS;</span></span>
<span class="line"><span style="color:#C678DD;">            expires </span><span style="color:#D19A66;">30d</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        location</span><span style="color:#ABB2BF;"> ~ .*\.(js|css)?$</span></span>
<span class="line"><span style="color:#ABB2BF;">        {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">            # 允许跨域请求</span></span>
<span class="line"><span style="color:#C678DD;">            add_header </span><span style="color:#ABB2BF;">Access-Control-Allow-Origin </span><span style="color:#98C379;">&#39;*&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">            add_header </span><span style="color:#ABB2BF;">Access-Control-Allow-Headers X-Requested-With;</span></span>
<span class="line"><span style="color:#C678DD;">            add_header </span><span style="color:#ABB2BF;">Access-Control-Allow-Methods GET,POST,OPTIONS;</span></span>
<span class="line"><span style="color:#C678DD;">            expires </span><span style="color:#D19A66;">12h</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        location</span><span style="color:#ABB2BF;"> ~ </span><span style="color:#E06C75;">/.well-known </span><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#C678DD;">       		allow </span><span style="color:#D19A66;">all</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">        location</span><span style="color:#ABB2BF;"> ~ /\.</span></span>
<span class="line"><span style="color:#ABB2BF;">        {</span></span>
<span class="line"><span style="color:#C678DD;">       		 eny</span><span style="color:#D19A66;"> all</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">       	access_log </span><span style="color:#D19A66;">off</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br></div></div><h2 id="配置中心" tabindex="-1">配置中心 <a class="header-anchor" href="#配置中心" aria-label="Permalink to &quot;配置中心&quot;">​</a></h2><p>版本管理、监控方案（埋点） 、 回滚方案</p><h2 id="源码解析" tabindex="-1">源码解析 <a class="header-anchor" href="#源码解析" aria-label="Permalink to &quot;源码解析&quot;">​</a></h2><p>本地代码注释，没来及摘抄出来</p><p>此处是 miacro-app 源码，跟乾坤原理大致相同</p><h3 id="渲染原理" tabindex="-1">渲染原理 <a class="header-anchor" href="#渲染原理" aria-label="Permalink to &quot;渲染原理&quot;">​</a></h3><p>架构思路为：<strong><a href="https://developer.mozilla.org/zh-CN/docs/Web/Web_Components/Using_custom_elements" target="_blank" rel="noreferrer">CustomElement</a> + HTMLEntry</strong>。</p><p>渲染大致流程：</p><ol><li>使用类 webcomponent 创建一个容器，name 和 url 是必须传的，后续子应用所有的元素都放到这个里面</li><li>然后在 webcomponent 自带的生命周期（<code>connectedCallback</code>），去加载子应用</li><li>创建微应用的实例，请求html，然后获取到一些静态资源的请求地址</li><li>根据静态资源地址请求静态资源遍历处理，请求完毕后进行渲染，此时css隔离和沙箱等流程开启</li><li>离开应用的时候会自动执行生命周期函数<code>disconnectedCallback</code>，此时会卸载相关操作</li></ol><p>注意： 一个页面只能有一个head标签，body也尽可能的保持一个，所以获取到的html ,会进行head和body的额外处理（qiankun是直接干掉了）。</p><h3 id="js沙箱" tabindex="-1">Js沙箱 <a class="header-anchor" href="#js沙箱" aria-label="Permalink to &quot;Js沙箱&quot;">​</a></h3><p>js沙箱流程：</p><p>乾坤早期是修改当前的window，然后离开在灰度有添加或者修改的值，保存好修改添加的值下次再进来重新赋值防止再次遍历。后来被优化掉了，直接使用监听的对象，对监听的对象赋值。</p><ol><li>Proxy监听一个空对象，取值的时候，先在当前对象下找没有的话就去window</li><li>赋值的时候先在当前的 target 下赋值，然后记录下来，应用离开的时候清空</li><li>更改应用中js的作用域</li><li>重写全局事件 addEventListener、removeEventListener（window、document）、 setInterval、setTimeout、clearInterval、clearTimeout</li></ol><p><strong>核心源码</strong></p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#C678DD;">class</span><span style="color:#E5C07B;"> SandBox</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#E06C75;">  active</span><span style="color:#56B6C2;"> =</span><span style="color:#D19A66;"> false</span><span style="color:#7F848E;font-style:italic;"> // 沙箱是否在运行</span></span>
<span class="line"><span style="color:#E06C75;">  microWindow</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> {} </span><span style="color:#7F848E;font-style:italic;">// 代理的对象</span></span>
<span class="line"><span style="color:#E06C75;">  injectedKeys</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> Set</span><span style="color:#ABB2BF;">() </span><span style="color:#7F848E;font-style:italic;">// 新添加的属性，在卸载时清空</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">  constructor</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#E5C07B;">    this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">proxyWindow</span><span style="color:#56B6C2;"> =</span><span style="color:#C678DD;"> new</span><span style="color:#61AFEF;"> Proxy</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">microWindow</span><span style="color:#ABB2BF;">, {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">      // 取值</span></span>
<span class="line"><span style="color:#61AFEF;">      get</span><span style="color:#ABB2BF;">: (</span><span style="color:#E06C75;font-style:italic;">target</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">key</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        // 优先从代理对象上取值</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">Reflect</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">has</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">target</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">key</span><span style="color:#ABB2BF;">)) {</span></span>
<span class="line"><span style="color:#C678DD;">          return</span><span style="color:#E5C07B;"> Reflect</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">target</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">key</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        // 否则兜底到window对象上取值</span></span>
<span class="line"><span style="color:#C678DD;">        const</span><span style="color:#E5C07B;"> rawValue</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> Reflect</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">window</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">key</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        // 其它情况直接返回</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#E06C75;"> rawValue</span></span>
<span class="line"><span style="color:#ABB2BF;">      },</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">      // 设置变量</span></span>
<span class="line"><span style="color:#61AFEF;">      set</span><span style="color:#ABB2BF;">: (</span><span style="color:#E06C75;font-style:italic;">target</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">key</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">value</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        // 沙箱只有在运行时可以设置变量</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">active</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">          Reflect</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">set</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">target</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">key</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">value</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">          // 记录添加的变量，用于后续清空操作</span></span>
<span class="line"><span style="color:#E5C07B;">          this</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">injectedKeys</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">add</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">key</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#D19A66;"> true</span></span>
<span class="line"><span style="color:#ABB2BF;">      },</span></span>
<span class="line"><span style="color:#61AFEF;">      deleteProperty</span><span style="color:#ABB2BF;">: (</span><span style="color:#E06C75;font-style:italic;">target</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">key</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        // 当前key存在于代理对象上时才满足删除条件</span></span>
<span class="line"><span style="color:#C678DD;">        if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">target</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">hasOwnProperty</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">key</span><span style="color:#ABB2BF;">)) {</span></span>
<span class="line"><span style="color:#C678DD;">          return</span><span style="color:#E5C07B;"> Reflect</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">deleteProperty</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">target</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">key</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#D19A66;"> true</span></span>
<span class="line"><span style="color:#ABB2BF;">      },</span></span>
<span class="line"><span style="color:#ABB2BF;">    })</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>沙箱的开启是在 创建微应用的时候开启，在 <code>mount</code> 函数里面执行，<code>unmount</code> 里面卸载</p><h4 id="更改作用域" tabindex="-1">更改作用域 <a class="header-anchor" href="#更改作用域" aria-label="Permalink to &quot;更改作用域&quot;">​</a></h4><p>大致进化结果就是这样</p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">window</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">self</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">    console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">window</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E5C07B;">    console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">})({</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">:</span><span style="color:#98C379;">&#39;wk&#39;</span><span style="color:#ABB2BF;">})</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">window</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">self</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#E5C07B;">    console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">window</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E5C07B;">    console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // console.log(name)</span></span>
<span class="line"><span style="color:#ABB2BF;">}).</span><span style="color:#61AFEF;">call</span><span style="color:#ABB2BF;">({</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">:</span><span style="color:#98C379;">&#39;wk&#39;</span><span style="color:#ABB2BF;">},{</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">:</span><span style="color:#98C379;">&#39;wk&#39;</span><span style="color:#ABB2BF;">})</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 终极</span></span>
<span class="line"><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">window</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">self</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">   with</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">window</span><span style="color:#ABB2BF;">){</span></span>
<span class="line"><span style="color:#E5C07B;">    console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E5C07B;">    console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">log</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">   }</span></span>
<span class="line"><span style="color:#ABB2BF;">}).</span><span style="color:#61AFEF;">call</span><span style="color:#ABB2BF;">({</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">:</span><span style="color:#98C379;">&#39;wk&#39;</span><span style="color:#ABB2BF;">},{</span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">:</span><span style="color:#98C379;">&#39;wk&#39;</span><span style="color:#ABB2BF;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="样式隔离" tabindex="-1">样式隔离 <a class="header-anchor" href="#样式隔离" aria-label="Permalink to &quot;样式隔离&quot;">​</a></h3><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/CSSRule" target="_blank" rel="noreferrer">CSSRule</a></p><p>bem cssmodules 这些东西不能用人来解决，一定要依赖平台化的一些治理工具</p><p>css隔离流程：</p><ol><li>html字符串转换为DOM结构后、或者将link元素转换为style元素调用<code>scopedCSS</code>方法，并将style元素作为参数传入</li><li>利用CSSRules 将style元素创建 CSSStyleList 样式表，然后 CSS 样式表包含了一组表示规则的CSSRule对象</li><li>然后遍历每一个 CSSStyleList 样式表，匹配每个符合规则的选择器前加上前缀<code>micro-app[name=xxx]</code></li><li>然后将修改后的样式，添加到创建的 style 内</li><li>监听style的元素变化，防止插入新的样式然后在进行隔离处理</li></ol><p>将link标签引入的远程css文件转换为style标签，所以子应用只会存在style标签，实现样式隔离的方式就是在style标签的每一个CSS规则前面加上<code>micro-app[name=xxx]</code>的前缀，让所有CSS规则都只能影响到指定元素内部。</p><p>所以cssRules就是由单个CSS规则组成的列表，我们只需要遍历规则列表，并在每个规则的选择器前加上前缀<code>micro-app[name=xxx]</code>，就可以将当前style样式的影响限制在micro-app元素内部。</p><p>防止开发者动态修改样式表，使用<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/MutationObserver" target="_blank" rel="noreferrer">MutationObserver</a>监听style元素的变化</p><p><strong>核心代码</strong></p><p><img src="https://tva1.sinaimg.cn/large/008i3skNly1guyqgjk03oj60oi0cydi102.jpg" alt=""></p><div class="language-javascript line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span style="color:#E5C07B;">window</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">onload</span><span style="color:#56B6C2;"> =</span><span style="color:#ABB2BF;"> () </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> link</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getElementsByTagName</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;link&#39;</span><span style="color:#ABB2BF;">)[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 获取 ruleStyleList 样式表</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> getStyleList</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">element</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">  let</span><span style="color:#E06C75;"> styleSheet</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> element</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">sheet</span><span style="color:#56B6C2;"> ||</span><span style="color:#E5C07B;"> element</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">styleSheet</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">  return</span><span style="color:#E5C07B;"> styleSheet</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">cssRules</span><span style="color:#56B6C2;"> ||</span><span style="color:#E5C07B;"> styleSheet</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">rules</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">let</span><span style="color:#E06C75;"> rules</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> getStyleList</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">link</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// 创建 StyleList样式表</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 渲染隔离后的 css</span></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> runStyle</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#C678DD;">  let</span><span style="color:#E06C75;"> templateStyle</span><span style="color:#56B6C2;"> =</span><span style="color:#E5C07B;"> document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">createElement</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;style&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E5C07B;">  templateStyle</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">id</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;templateStyle&#39;</span></span>
<span class="line"><span style="color:#E5C07B;">  templateStyle</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">textContent</span><span style="color:#56B6C2;"> =</span><span style="color:#61AFEF;"> scopedRule</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">rules</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;micro-app[name=wk]&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">  document</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">body</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">appendChild</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">templateStyle</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  // 设置样式表无效，防止对应用造成影响</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  // templateStyle.sheet.disabled = true</span></span>
<span class="line"><span style="color:#E5C07B;">  link</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">parentNode</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">removeChild</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">link</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;font-style:italic;">// 删除之前link 的样式</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">runStyle</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> scopedRule</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">rules</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">prefix</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">  let</span><span style="color:#E06C75;"> result</span><span style="color:#56B6C2;"> =</span><span style="color:#98C379;"> &#39;&#39;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  // 遍历rules，处理每一条规则</span></span>
<span class="line"><span style="color:#C678DD;">  for</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">const</span><span style="color:#E5C07B;"> rule</span><span style="color:#C678DD;"> of</span><span style="color:#E06C75;"> rules</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">    switch</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">rule</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">type</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;">      case</span><span style="color:#D19A66;"> 1</span><span style="color:#ABB2BF;">: </span><span style="color:#7F848E;font-style:italic;">// STYLE_RULE</span></span>
<span class="line"><span style="color:#E06C75;">        result</span><span style="color:#56B6C2;"> +=</span><span style="color:#61AFEF;"> scopedStyleRule</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">rule</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">prefix</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">        break</span></span>
<span class="line"><span style="color:#C678DD;">      default</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;">        result</span><span style="color:#56B6C2;"> +=</span><span style="color:#E5C07B;"> rule</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">cssText</span></span>
<span class="line"><span style="color:#C678DD;">        break</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#C678DD;">  return</span><span style="color:#E06C75;"> result</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">function</span><span style="color:#61AFEF;"> scopedStyleRule</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">rule</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">prefix</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  // 获取CSS规则对象的选择和内容</span></span>
<span class="line"><span style="color:#C678DD;">  const</span><span style="color:#ABB2BF;"> {</span><span style="color:#E5C07B;">selectorText</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">cssText</span><span style="color:#ABB2BF;">} </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> rule</span></span>
<span class="line"><span style="color:#C678DD;">  if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">/</span><span style="color:#C678DD;">^</span><span style="color:#E06C75;">((html</span><span style="color:#D19A66;">[</span><span style="color:#E06C75;">\s</span><span style="color:#D19A66;">&gt;~,]+</span><span style="color:#E06C75;">body)</span><span style="color:#ABB2BF;">|</span><span style="color:#E06C75;">(html</span><span style="color:#ABB2BF;">|</span><span style="color:#E06C75;">body</span><span style="color:#ABB2BF;">|</span><span style="color:#E06C75;">:root))</span><span style="color:#C678DD;">$</span><span style="color:#E06C75;">/</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">test</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">selectorText</span><span style="color:#ABB2BF;">)) {</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#E5C07B;"> cssText</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">/</span><span style="color:#C678DD;">^</span><span style="color:#E06C75;">((html</span><span style="color:#D19A66;">[</span><span style="color:#E06C75;">\s</span><span style="color:#D19A66;">&gt;~,]+</span><span style="color:#E06C75;">body)</span><span style="color:#ABB2BF;">|</span><span style="color:#E06C75;">(html</span><span style="color:#ABB2BF;">|</span><span style="color:#E06C75;">body</span><span style="color:#ABB2BF;">|</span><span style="color:#E06C75;">:root))/</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">prefix</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">  } </span><span style="color:#C678DD;">else</span><span style="color:#C678DD;"> if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">selectorText</span><span style="color:#56B6C2;"> ===</span><span style="color:#98C379;"> &#39;*&#39;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // return cssText.replace(&#39;*&#39;, `${prefix} *`)</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#E5C07B;"> cssText</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;*&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">`*`</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">  const</span><span style="color:#E5C07B;"> builtInRootSelectorRE</span><span style="color:#56B6C2;"> =</span><span style="color:#E06C75;"> /(</span><span style="color:#C678DD;">^</span><span style="color:#ABB2BF;">|</span><span style="color:#E06C75;">\s</span><span style="color:#D19A66;">+</span><span style="color:#E06C75;">)((html</span><span style="color:#D19A66;">[</span><span style="color:#E06C75;">\s</span><span style="color:#D19A66;">&gt;~]+</span><span style="color:#E06C75;">body)</span><span style="color:#ABB2BF;">|</span><span style="color:#E06C75;">(html</span><span style="color:#ABB2BF;">|</span><span style="color:#E06C75;">body</span><span style="color:#ABB2BF;">|</span><span style="color:#E06C75;">:root))(?=</span><span style="color:#D19A66;">[</span><span style="color:#E06C75;">\s</span><span style="color:#D19A66;">&gt;~]+</span><span style="color:#ABB2BF;">|</span><span style="color:#C678DD;">$</span><span style="color:#E06C75;">)/</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  // 匹配查询选择器</span></span>
<span class="line"><span style="color:#C678DD;">  return</span><span style="color:#E5C07B;"> cssText</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">/</span><span style="color:#C678DD;">^</span><span style="color:#D19A66;">[</span><span style="color:#E06C75;">\s\S</span><span style="color:#D19A66;">]+</span><span style="color:#E06C75;">{/</span><span style="color:#ABB2BF;">, (</span><span style="color:#E06C75;font-style:italic;">selectors</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#C678DD;">    return</span><span style="color:#E5C07B;"> selectors</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">/(</span><span style="color:#C678DD;">^</span><span style="color:#ABB2BF;">|</span><span style="color:#E06C75;">,)(</span><span style="color:#D19A66;">[</span><span style="color:#ABB2BF;">^</span><span style="color:#D19A66;">,]+</span><span style="color:#E06C75;">)/</span><span style="color:#C678DD;">g</span><span style="color:#ABB2BF;">, (</span><span style="color:#E06C75;font-style:italic;">all</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">$1</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">$2</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">      // 如果含有顶层选择器，需要单独处理</span></span>
<span class="line"><span style="color:#C678DD;">      if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">builtInRootSelectorRE</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">test</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">$2</span><span style="color:#ABB2BF;">)) {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">        // body[name=xx]|body.xx|body#xx 等都不需要转换</span></span>
<span class="line"><span style="color:#C678DD;">        return</span><span style="color:#E5C07B;"> all</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">builtInRootSelectorRE</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">prefix</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">      }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">      // 在选择器前加上前缀</span></span>
<span class="line"><span style="color:#C678DD;">      return</span><span style="color:#98C379;"> `</span><span style="color:#C678DD;">${</span><span style="color:#E06C75;">$1</span><span style="color:#C678DD;">}</span><span style="color:#C678DD;"> ${</span><span style="color:#E06C75;">prefix</span><span style="color:#C678DD;">}</span><span style="color:#C678DD;"> ${</span><span style="color:#E5C07B;">$2</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">/</span><span style="color:#C678DD;">^</span><span style="color:#E06C75;">\s</span><span style="color:#D19A66;">*</span><span style="color:#E06C75;">/</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">)</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">`</span></span>
<span class="line"><span style="color:#ABB2BF;">    })</span></span>
<span class="line"><span style="color:#ABB2BF;">  })</span></span>
<span class="line"><span style="color:#ABB2BF;"> }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br></div></div><h2 id="参考文档" tabindex="-1">参考文档 <a class="header-anchor" href="#参考文档" aria-label="Permalink to &quot;参考文档&quot;">​</a></h2><p><a href="https://zhuanlan.zhihu.com/p/78362028" target="_blank" rel="noreferrer">蚂蚁 有知(乾坤) 沙盒内容</a></p><p><a href="https://juejin.im/post/6844904158085021704?utm_source=gold_browser_extension" target="_blank" rel="noreferrer">基于 qiankun 的微前端最佳实践（万字长文） - 从 0 到 1 篇</a></p><p><a href="https://github.com/a1029563229/micro-front-template/tree/feature-inject-sub-apps" target="_blank" rel="noreferrer">微前端架构模板</a></p><p><a href="https://github.com/single-spa/single-spa" target="_blank" rel="noreferrer">微服务的JavaScript框架 single-spa</a></p><p><a href="https://qiankun.umijs.org/zh" target="_blank" rel="noreferrer">乾坤文档</a></p><p><a href="https://zhuanlan.zhihu.com/p/141576317" target="_blank" rel="noreferrer">一些关于微前端的文章</a></p><p><a href="https://xiaomi-info.github.io/2020/04/14/fe-microfrontends-practice/" target="_blank" rel="noreferrer">微前端在小米 CRM 系统的实践</a></p><p><a href="https://v.youku.com/v_show/id_XNDUwNTc0MTUwNA==.html?spm=a2hbt.13141534.app.5~5!2~5!2~5~5~5!2~5~5!2~5!2~5!2~5~5!19~A" target="_blank" rel="noreferrer">d2峰会 微前端视频有三篇</a></p></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-09de1c0f><!--[--><!--]--><div class="edit-info" data-v-09de1c0f><div class="edit-link" data-v-09de1c0f><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/80591622" target="_blank" rel="noreferrer" data-v-09de1c0f><!--[--><span class="vpi-square-pen edit-link-icon" data-v-09de1c0f></span> https://github.com/80591622<!--]--></a></div><div class="last-updated" data-v-09de1c0f><p class="VPLastUpdated" data-v-09de1c0f data-v-7e05ebdb>上次更新: <time datetime="2024-04-24T15:11:23.000Z" data-v-7e05ebdb></time></p></div></div><nav class="prev-next" data-v-09de1c0f><div class="pager" data-v-09de1c0f><!----></div><div class="pager" data-v-09de1c0f><a class="VPLink link pager-link next" href="/workspace/Js/home.html" data-v-09de1c0f><!--[--><span class="desc" data-v-09de1c0f>下一篇</span><span class="title" data-v-09de1c0f>技术清单</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-5d98c3a5 data-v-e315a0ad><div class="container" data-v-e315a0ad><p class="message" data-v-e315a0ad>京ICP备18059340号</p><p class="copyright" data-v-e315a0ad>Copyright © 2019 - 2024 Corporation, All Rights Reserved</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"workspace_css_clearfix.md\":\"Ci95w0fz\",\"photos_index.md\":\"ZisHxPKR\",\"todos_index.md\":\"D5DWwvZg\",\"tools_page.md\":\"DJxrtSCG\",\"workspace_css_bfc.md\":\"D7tH6EzK\",\"tag_index.md\":\"DR4NhQiF\",\"tools_store.md\":\"DmNeeiri\",\"workspace_css_cssmodules.md\":\"DJb-mDio\",\"other_ws-configure.md\":\"v2MMVFl2\",\"workspace_analysis_charts.md\":\"BzjmcA1z\",\"workspace_css_hidden.md\":\"hHEe7KQm\",\"workspace_css_lattice.md\":\"CkTfqg1C\",\"other_hot.md\":\"CC1jSjyI\",\"workspace_css_box-sizing.md\":\"BUpmjaYG\",\"workspace_css_flex.md\":\"CtSboHF3\",\"workspace_electron_base.md\":\"BMOFTwDe\",\"index.md\":\"BEq6oeHt\",\"workspace_frame_react-native_bug.md\":\"BSlr0OKE\",\"workspace_flutter_base.md\":\"BDvohoX9\",\"workspace_frame_irdd_irdd.md\":\"Co2tbHji\",\"workspace_frame_react-native_base.md\":\"4lKnBq_Q\",\"tools_mac.md\":\"BUbVyJPy\",\"workspace_css_css.md\":\"C7d2KE04\",\"workspace_frame_react_fiber.md\":\"CJ5s_Sn4\",\"workspace_frame_react_dva.md\":\"BxZIThkf\",\"workspace_frame_react-native_guide.md\":\"CyfzIxo9\",\"workspace_frame_react_event.md\":\"cLJLpJpa\",\"workspace_frame_react_problem.md\":\"CYLpJG1Y\",\"workspace_frame_react_immer.md\":\"DRuBbDaX\",\"workspace_frame_react_dom_diff.md\":\"83Uu8rC8\",\"workspace_frame_mic_mic.md\":\"BZNBSOf3\",\"workspace_frame_react_react-router.md\":\"5Yd9QDds\",\"workspace_frame_react_react-hooks.md\":\"CHan9H1X\",\"workspace_frame_react_react-redux.md\":\"DhBwNZ2r\",\"workspace_frame_react_reactcomponent.md\":\"CJZzqBit\",\"workspace_frame_taro_taroadvanced.md\":\"c9gyhkyg\",\"workspace_frame_react_react.md\":\"BVUUqbeA\",\"workspace_frame_taro_toc.md\":\"Bb0hwEcb\",\"workspace_frame_taro_template.md\":\"nTImDGqM\",\"workspace_frame_unit-test_jest.md\":\"ug7t5st-\",\"workspace_frame_vue_error-handler.md\":\"DIr8cabd\",\"workspace_frame_react_ssr.md\":\"T0r9P-W5\",\"workspace_frame_vue_next_computed.md\":\"Dud4r8tL\",\"workspace_frame_vue_next_reactive.md\":\"B_wmCPZk\",\"workspace_frame_vue_next_effect.md\":\"D9EqSEnv\",\"workspace_frame_taro_tarobase.md\":\"B6_U0DvQ\",\"workspace_frame_vue_prerender.md\":\"DAZWERBH\",\"workspace_frame_vue_problem.md\":\"fbhVddPd\",\"workspace_frame_vue_next_ref.md\":\"8nrPNwMo\",\"workspace_frame_vue_sortable.md\":\"_dUtgnWJ\",\"workspace_frame_vue_reload.md\":\"Gnj5jUne\",\"workspace_frame_vue_keep-alive.md\":\"DGF7paC-\",\"workspace_frame_vue_next_reactivity.md\":\"DmnZ61HF\",\"workspace_frame_vue_jsx.md\":\"BNXpBC_V\",\"workspace_frame_vue_use-project.md\":\"8ENeDFzM\",\"workspace_frame_vue_source-code_vue-extend.md\":\"D0mpK4Ro\",\"workspace_frame_vue_source-code_keep-alive.md\":\"CJbo1eg7\",\"workspace_frame_vue_tree-menu.md\":\"lkN0MPG_\",\"workspace_frame_vue_table-jsx.md\":\"yj6xLwvg\",\"workspace_frame_vue_vue-next.md\":\"B9X9VCAd\",\"workspace_frame_vue_vue-cli.md\":\"Cf85Q2Ym\",\"workspace_git_git-cherry.md\":\"B7HEB6g5\",\"workspace_frame_vue_with-search.md\":\"dqC8blpj\",\"workspace_git_github.md\":\"C4cEFTLz\",\"workspace_gulp_base.md\":\"DvJoqhO9\",\"workspace_git_git-hooks.md\":\"Br1GhzyJ\",\"workspace_interviews_list.md\":\"B-finrBG\",\"workspace_interviews_security.md\":\"DpaQC8Pf\",\"workspace_interviews_theory.md\":\"CYLe3AV1\",\"workspace_git_git.md\":\"DMyUPQXD\",\"workspace_jenkins_base.md\":\"DCKF0SQ1\",\"workspace_interviews_result.md\":\"BsAH-z_V\",\"workspace_js_date.md\":\"C1ieYgHN\",\"workspace_js_design-pattern.md\":\"CjHXWdAS\",\"workspace_js_dispatchevent.md\":\"ClkEGDq6\",\"workspace_js_export.md\":\"CFSOw07M\",\"workspace_frame_vue_vue.md\":\"c9ZnDAnl\",\"workspace_js_es6.md\":\"Cqcg7flS\",\"workspace_js_eventloop.md\":\"Cq58kd_D\",\"workspace_js_array.md\":\"f1BHkTci\",\"workspace_js_heap_stack.md\":\"DYzcEZqa\",\"workspace_js_for-in-for-of.md\":\"BTKnnGvY\",\"workspace_js_http-base.md\":\"BfuLuHmC\",\"workspace_js_extends.md\":\"Bzqff7Y9\",\"workspace_js_reg.md\":\"CaRNARKa\",\"workspace_js_string.md\":\"DWy0C2dg\",\"workspace_js_theme.md\":\"DTMVB60q\",\"workspace_js_socket.md\":\"CxhlcEhN\",\"workspace_js_object.md\":\"Br_pcW_Q\",\"workspace_project_copy.md\":\"HOR_HXHo\",\"workspace_js_promise.md\":\"CbJOzxTr\",\"workspace_project_cookie.md\":\"1ibUjvFH\",\"workspace_js_webworker.md\":\"D0W-4HxU\",\"workspace_js_home.md\":\"Bq0Z87QL\",\"workspace_js_xhr.md\":\"B2bsRqZm\",\"workspace_js_water-mask.md\":\"CUEGpS4T\",\"workspace_project_leetcode.md\":\"DBw_Zzw8\",\"workspace_project_more.md\":\"Q2UCw7SE\",\"workspace_project_qiyunniu.md\":\"C14n4v11\",\"workspace_project_immutable.md\":\"CaI0PBZf\",\"workspace_project_screenfull.md\":\"C8DSPRfe\",\"workspace_project_yarn.md\":\"Cmeyt_DK\",\"workspace_rollup_base.md\":\"cO9YmqdB\",\"workspace_server_lnmp.md\":\"DRXH02e7\",\"workspace_project_linux.md\":\"C4sJfXUd\",\"workspace_server_api_graphql.md\":\"B2iptdol\",\"workspace_server_node_base.md\":\"DDm0OcgZ\",\"workspace_project_method.md\":\"DgbEmoCs\",\"workspace_server_nginx_nginx_base.md\":\"BrUOKykV\",\"workspace_server_nginx_nginx_local.md\":\"BBFedRDi\",\"workspace_project_tofixed.md\":\"plpTDTa1\",\"workspace_server_sql_mongodb.md\":\"BQGbyVca\",\"workspace_server_node_pm2.md\":\"BPIt2nYt\",\"workspace_server_token.md\":\"D2_9Umsy\",\"workspace_server_node_node-console.md\":\"CA1XIlPa\",\"workspace_server_sql_mongoose.md\":\"CLgnuLDf\",\"workspace_snowpack_base.md\":\"JMY0t-vP\",\"workspace_server_node_node-2.md\":\"DQBQkOQj\",\"workspace_typescript_ts-object-type-interface.md\":\"CJBT5oNb\",\"workspace_typescript_tsconfig.md\":\"zoKNgKoI\",\"workspace_server_node_node-1.md\":\"BJA7Fovq\",\"workspace_vite_base.md\":\"B7KRmjHZ\",\"workspace_webpack_babel_polyfill.md\":\"6ylBnWUE\",\"workspace_typescript_use.md\":\"B8yzRjEh\",\"workspace_webpack_webpack.md\":\"DhCjfh3k\",\"workspace_webpack_use.md\":\"CWmynMjL\",\"workspace_typescript_ts.md\":\"BfadzuWb\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"zh\",\"dir\":\"ltr\",\"title\":\"Oasis Blog\",\"description\":\"软件开发计：开发文档和开发计划，完成功能工具，和待开发的功能和工具\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"search\":{\"provider\":\"local\",\"options\":{\"locales\":{\"root\":{\"translations\":{\"button\":{\"buttonText\":\"搜索文档\",\"buttonAriaLabel\":\"搜索文档\"},\"modal\":{\"noResultsText\":\"无法找到相关结果\",\"displayDetails\":\"显示详细信息\",\"resetButtonTitle\":\"清除查询条件\",\"backButtonTitle\":\"返回搜索结果\",\"footer\":{\"selectText\":\"选择\",\"selectKeyAriaLabel\":\"enter\",\"navigateText\":\"切换\",\"navigateUpKeyAriaLabel\":\"up arrow\",\"navigateDownKeyAriaLabel\":\"down arrow\",\"closeText\":\"关闭\",\"closeKeyAriaLabel\":\"escape\"}}}}},\"miniSearch\":{\"options\":{},\"searchOptions\":{}}}},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://gitee.com/muyaCode/program-learn-notes\"}],\"sidebar\":{\"/\":[{\"text\":\"Base\",\"collapsed\":false,\"items\":[{\"text\":\"技术清单\",\"link\":\"/workspace/Js/home\"},{\"text\":\"Array的方法简单整理\",\"link\":\"/workspace/Js/array\"},{\"text\":\"Object的方法简单整理\",\"link\":\"/workspace/Js/object\"},{\"text\":\"String的方法简单整理\",\"link\":\"/workspace/Js/string\"},{\"text\":\"Date时间\",\"link\":\"/workspace/Js/date\"},{\"text\":\"RegExp正则\",\"link\":\"/workspace/Js/reg\"},{\"text\":\"CSS使用锦囊\",\"link\":\"/workspace/Css/css\"},{\"text\":\"自定义事件\",\"link\":\"/workspace/Js/dispatchEvent\"},{\"text\":\"for in和for of区别\",\"link\":\"/workspace/Js/for-in-for-of\"},{\"text\":\"ES6-新增特性一览\",\"link\":\"/workspace/Js/es6\"},{\"text\":\"Event-Loop\",\"link\":\"/workspace/Js/eventloop\"},{\"text\":\"Promise & async\",\"link\":\"/workspace/Js/promise\"},{\"text\":\"Web Worker\",\"link\":\"/workspace/Js/webWorker\"},{\"text\":\"WebSocket & socket.io\",\"link\":\"/workspace/Js/socket\"},{\"text\":\"shell & ssh\",\"link\":\"/workspace/Project/linux\"},{\"text\":\"yarn & npm\",\"link\":\"/workspace/Project/yarn\"},{\"text\":\"堆内存 & 栈内存\",\"link\":\"/workspace/Js/heap_stack\"},{\"text\":\"Fetch和Axios的区别\",\"link\":\"/workspace/Js/xhr\"},{\"text\":\"JS设计模式探索\",\"link\":\"/workspace/Js/design-pattern\"},{\"text\":\"输入URL背后的技术步骤\",\"link\":\"/workspace/Js/http-base\"},{\"text\":\"原型与原型链\",\"link\":\"/workspace/Js/extends\"},{\"text\":\"leetCode\",\"link\":\"/workspace/Project/leetcode\"}]},{\"text\":\"Project\",\"collapsed\":true,\"items\":[{\"text\":\"用到的方法\",\"link\":\"/workspace/Project/method\"},{\"text\":\"简易封装Cookie\",\"link\":\"/workspace/Project/cookie\"},{\"text\":\"toFixed方法的bug\",\"link\":\"/workspace/Project/toFixed\"},{\"text\":\"实现JS复制内容到剪贴板\",\"link\":\"/workspace/Project/copy\"},{\"text\":\"全屏实现方案\",\"link\":\"/workspace/Project/screenfull\"},{\"text\":\"base64上传七云获取key\",\"link\":\"/workspace/Project/qiyunniu\"},{\"text\":\"聊一聊前端换肤\",\"link\":\"/workspace/Js/theme\"},{\"text\":\"JS添加水印功能\",\"link\":\"/workspace/Js/water-mask\"},{\"text\":\"Axios 获取文件流导出 excel 表格\",\"link\":\"/workspace/Js/export\"},{\"text\":\"会用到的插件\",\"link\":\"/workspace/Project/more\"}]},{\"text\":\"FE框架\",\"collapsed\":true,\"items\":[{\"text\":\"☞ vue\",\"collapsed\":true,\"items\":[{\"text\":\"vue基本用法\",\"link\":\"/workspace/Frame/vue/vue\"},{\"text\":\"vue中使用JSX\",\"link\":\"/workspace/Frame/vue/jsx\"},{\"text\":\"脚手架vue-cli\",\"link\":\"/workspace/Frame/vue/vue-cli\"},{\"text\":\"问题验证解析\",\"link\":\"/workspace/Frame/vue/problem\"},{\"text\":\"Vue预渲染\",\"link\":\"/workspace/Frame/vue/prerender\"},{\"text\":\"踩坑记录\",\"collapsed\":true,\"items\":[{\"text\":\"使用keepAlive遇到的坑\",\"link\":\"/workspace/Frame/vue/keep-alive\"}]},{\"text\":\"使用拓展\",\"collapsed\":true,\"items\":[{\"text\":\"vue之JSX封装table\",\"link\":\"/workspace/Frame/vue/table-jsx\"},{\"text\":\"Element-UI ，Table组件实现拖拽效果\",\"link\":\"/workspace/Frame/vue/sortable\"},{\"text\":\"Vue之JSX封装搜索头部\",\"link\":\"/workspace/Frame/vue/with-search\"},{\"text\":\"封装树形菜单\",\"link\":\"/workspace/Frame/vue/tree-menu\"},{\"text\":\"基于Vue的组件局部刷新\",\"link\":\"/workspace/Frame/vue/reload\"}]},{\"text\":\"源码分析\",\"collapsed\":true,\"items\":[{\"text\":\"vue3.0源码分析-1\",\"link\":\"/workspace/Frame/vue/next/reactivity\"},{\"text\":\"Vue3.0源码分析-2\",\"link\":\"/workspace/Frame/vue/vue-next\"},{\"text\":\"Vue之JSX封装搜索头部\",\"link\":\"/workspace/Frame/vue/error-handler\"},{\"text\":\"封装树形菜单\",\"link\":\"/workspace/Frame/vue/source-code/keep-alive\"},{\"text\":\"基于Vue的组件局部刷新\",\"link\":\"/workspace/Frame/vue/source-code/vue-extend\"}]},{\"text\":\"UI组件库\",\"collapsed\":true,\"items\":[{\"text\":\"irdd 组件库\",\"link\":\"/workspace/Frame/irdd/irdd\"}]}]},{\"text\":\"☞ react\",\"collapsed\":true,\"items\":[{\"text\":\"React基本用法\",\"link\":\"/workspace/Frame/react/react\"},{\"text\":\"Hooks\",\"link\":\"/workspace/Frame/react/react-hooks\"},{\"text\":\"Immer\",\"link\":\"/workspace/Frame/react/immer\"},{\"text\":\"Router原理\",\"link\":\"/workspace/Frame/react/react-router\"},{\"text\":\"Redux源码解析\",\"link\":\"/workspace/Frame/react/react-redux\"},{\"text\":\"Dva封装\",\"link\":\"/workspace/Frame/react/dva\"},{\"text\":\"react事件委托机制\",\"link\":\"/workspace/Frame/react/event\"},{\"text\":\"React16 Fiber\",\"link\":\"/workspace/Frame/react/fiber\"},{\"text\":\"VirtualDOM\",\"link\":\"/workspace/Frame/react/dom_diff\"},{\"text\":\"React-SSR\",\"link\":\"/workspace/Frame/react/ssr\"},{\"text\":\"问题验证解析\",\"link\":\"/workspace/Frame/react/problem\"}]},{\"text\":\"☞ taro\",\"collapsed\":true,\"items\":[{\"text\":\"Taro基本用法\",\"link\":\"/workspace/Frame/taro/taroBase\"},{\"text\":\"Taro一些配置\",\"link\":\"/workspace/Frame/taro/taroAdvanced\"},{\"text\":\"Node生成模板\",\"link\":\"/workspace/Frame/taro/template\"},{\"text\":\"项目目录\",\"link\":\"/workspace/Frame/taro/toc\"}]},{\"text\":\"☞ react-native\",\"collapsed\":true,\"items\":[{\"text\":\"RN基本用法\",\"link\":\"/workspace/Frame/react-native/guide\"},{\"text\":\"RN IOS环境搭建\",\"link\":\"/workspace/Frame/react-native/base\"},{\"text\":\"XCODE模拟器报错修复\",\"link\":\"/workspace/Frame/react-native/bug\"}]},{\"text\":\"☞ 单元测试\",\"collapsed\":true,\"items\":[{\"text\":\"单元测试框架Jest学习总结\",\"link\":\"/workspace/Frame/unit-test/jest\"}]}]},{\"text\":\"Server\",\"collapsed\":true,\"items\":[{\"text\":\"☞ NodeJS\",\"collapsed\":true,\"items\":[{\"text\":\"NodeJs的原生方法\",\"link\":\"/workspace/Server/node/base\"},{\"text\":\"Koa2\",\"link\":\"/workspace/Server/node/node-1\"},{\"text\":\"NodeJs 插件拓展\",\"link\":\"/workspace/Server/node/node-2\"},{\"text\":\"Node启动工具\",\"link\":\"/workspace/Server/node/pm2\"},{\"text\":\"终端实现console输出不同颜色\",\"link\":\"/workspace/Server/node/node-console\"}]},{\"text\":\"☞ Mongoose\",\"collapsed\":true,\"items\":[{\"text\":\"Mongodb安装\",\"link\":\"/workspace/Server/sql/mongodb\"},{\"text\":\"Mongoose使用\",\"link\":\"/workspace/Server/sql/mongoose\"}]},{\"text\":\"☞ Nginx\",\"collapsed\":true,\"items\":[{\"text\":\"Nginx的使用指南\",\"link\":\"/workspace/Server/nginx/nginx_base\"},{\"text\":\"安装Nginx踩到的坑\",\"link\":\"/workspace/Server/nginx/nginx_local\"}]},{\"text\":\"云服务器配置\",\"link\":\"/workspace/Server/lnmp\"},{\"text\":\"什么是cookie,token和session?它们之间有什么关系？\",\"link\":\"/workspace/Server/token\"}]},{\"text\":\"TypeScript\",\"collapsed\":true,\"items\":[{\"text\":\"TypeScript\",\"link\":\"/workspace/Typescript/ts\"},{\"text\":\"TypeScr 误区\",\"link\":\"/workspace/Typescript/ts-object-type-interface.md\"},{\"text\":\"tsconfig了解一下\",\"link\":\"/workspace/Typescript/tsConfig\"}]},{\"text\":\"构建工具 \",\"collapsed\":true,\"items\":[{\"text\":\"☞ webpack\",\"collapsed\":true,\"items\":[{\"text\":\"Webpack4 配置详解\",\"link\":\"/workspace/Webpack/webpack\"},{\"text\":\"Webpack的使用\",\"link\":\"/workspace/Webpack/use\"},{\"text\":\"babel_polyfill\",\"link\":\"/workspace/Webpack/babel_polyfill\"}]},{\"text\":\"☞ gulp\",\"collapsed\":true,\"items\":[{\"text\":\"gulp\",\"link\":\"/workspace/Gulp/base\"}]},{\"text\":\"☞ rollup\",\"collapsed\":true,\"items\":[{\"text\":\"rollup\",\"link\":\"/workspace/Rollup/base\"}]},{\"text\":\"☞ snowpack\",\"collapsed\":true,\"items\":[{\"text\":\"snowpack\",\"link\":\"/workspace/Snowpack/base\"}]},{\"text\":\"☞ vite\",\"collapsed\":true,\"items\":[{\"text\":\"vite\",\"link\":\"/workspace/Vite/base\"}]}]},{\"text\":\"Git教程\",\"collapsed\":true,\"items\":[{\"text\":\"git基础\",\"link\":\"/workspace/Git/git\"},{\"text\":\"git恢复上一次的修改\",\"link\":\"/workspace/Git/git-cherry\"},{\"text\":\"git hooks\",\"link\":\"/workspace/Git/git-hooks\"},{\"text\":\"github API 调用\",\"link\":\"/workspace/Git/github\"}]},{\"text\":\"Other\",\"collapsed\":true,\"items\":[{\"text\":\"Jenkins自动化部署\",\"link\":\"/workspace/Jenkins/base\"},{\"text\":\"MAC整理\",\"link\":\"/tools/mac\"},{\"text\":\"开发工具\",\"link\":\"/tools/store\"},{\"text\":\"网站大全\",\"link\":\"/tools/page\"},{\"text\":\"配置WS\",\"link\":\"/other/ws-configure\"},{\"text\":\"习题解答\",\"link\":\"/workspace/Interviews/result\"}]}]},\"nav\":[{\"text\":\"Useful\",\"items\":[{\"text\":\"Vue\",\"link\":\"/workspace/Frame/vue/vue\"},{\"text\":\"React\",\"link\":\"/workspace/Frame/react/react\"},{\"text\":\"Taro\",\"link\":\"/workspace/Frame/taro/taroBase\"}]}],\"editLink\":{\"pattern\":\"https://github.com/80591622\",\"text\":\"https://github.com/80591622\"},\"lastUpdated\":{\"text\":\"上次更新\",\"formatOptions\":{\"dateStyle\":\"full\",\"timeStyle\":\"medium\"}},\"docFooter\":{\"prev\":\"上一篇\",\"next\":\"下一篇\"},\"footer\":{\"message\":\"京ICP备18059340号\",\"copyright\":\"Copyright © 2019 - 2024 Corporation, All Rights Reserved\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>